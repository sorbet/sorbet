<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Frequently Asked Questions · Sorbet</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Why does Sorbet think this is `nil`? I just checked that it&#x27;s not!"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Frequently Asked Questions · Sorbet"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sorbet.org/"/><meta property="og:description" content="## Why does Sorbet think this is `nil`? I just checked that it&#x27;s not!"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://sorbet.org/blog/atom.xml" title="Sorbet Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://sorbet.org/blog/feed.xml" title="Sorbet Blog RSS Feed"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5H7PQ9Z8KF"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'G-5H7PQ9Z8KF');
            </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/sorbet-logo-white-sparkles.svg" alt="Sorbet"/><h2 class="headerTitleWithLogo">Sorbet</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/adopting" target="_self">Get started</a></li><li class="siteNavGroupActive"><a href="/docs/overview" target="_self">Docs</a></li><li class=""><a href="https://sorbet.run" target="_self">Try</a></li><li class=""><a href="/en/community" target="_self">Community</a></li><li class=""><a href="https://github.com/sorbet/sorbet" target="_self">GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Troubleshooting</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/adopting">Adopting Sorbet</a></li><li class="navListItem"><a class="navItem" href="/docs/metrics">Tracking Adoption</a></li><li class="navListItem"><a class="navItem" href="/docs/quickref">Quick Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/vscode">Visual Studio Code</a></li><li class="navListItem"><a class="navItem" href="/docs/from-typescript">TypeScript ↔ Sorbet</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Static &amp; Runtime</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/gradual">Gradual Type Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/static">Enabling Static Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime">Enabling Runtime Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/rbi">RBI Files</a></li><li class="navListItem"><a class="navItem" href="/docs/cli">CLI Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/cli-ref">CLI Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/tconfiguration">Runtime Configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/why-type-annotations">Why type annotations?</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/faq">FAQ</a></li><li class="navListItem"><a class="navItem" href="/docs/error-reference">Error Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/unsupported">Unsupported Ruby Features</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Type System</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/sigs">sig</a></li><li class="navListItem"><a class="navItem" href="/docs/type-annotations">Type Annotations (non-sig)</a></li><li class="navListItem"><a class="navItem" href="/docs/type-assertions">T.let, T.cast, T.must, T.bind</a></li><li class="navListItem"><a class="navItem" href="/docs/class-types">Class Types (Integer, String)</a></li><li class="navListItem"><a class="navItem" href="/docs/stdlib-generics">Arrays &amp; Hashes</a></li><li class="navListItem"><a class="navItem" href="/docs/nilable-types">Nilable Types (T.nilable)</a></li><li class="navListItem"><a class="navItem" href="/docs/union-types">Union Types (T.any)</a></li><li class="navListItem"><a class="navItem" href="/docs/flow-sensitive">Flow-Sensitivity (is_a?, nil?)</a></li><li class="navListItem"><a class="navItem" href="/docs/type-aliases">T.type_alias</a></li><li class="navListItem"><a class="navItem" href="/docs/exhaustiveness">Exhaustiveness (T.absurd)</a></li><li class="navListItem"><a class="navItem" href="/docs/tstruct">T::Struct</a></li><li class="navListItem"><a class="navItem" href="/docs/tenum">T::Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/untyped">T.untyped</a></li><li class="navListItem"><a class="navItem" href="/docs/procs">Blocks, Procs, &amp; Lambdas</a></li><li class="navListItem"><a class="navItem" href="/docs/abstract">Abstract Classes &amp; Interfaces</a></li><li class="navListItem"><a class="navItem" href="/docs/final">Final Methods &amp; Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/override-checking">Override Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/sealed">Sealed Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/class-of">T.class_of</a></li><li class="navListItem"><a class="navItem" href="/docs/self-type">T.self_type</a></li><li class="navListItem"><a class="navItem" href="/docs/noreturn">T.noreturn</a></li><li class="navListItem"><a class="navItem" href="/docs/anything">T.anything</a></li><li class="navListItem"><a class="navItem" href="/docs/attached-class">T.attached_class</a></li><li class="navListItem"><a class="navItem" href="/docs/intersection-types">Intersection Types (T.all)</a></li><li class="navListItem"><a class="navItem" href="/docs/generics">Generics</a></li><li class="navListItem"><a class="navItem" href="/docs/non-forcing-constants">T::NonForcingConstants</a></li><li class="navListItem"><a class="navItem" href="/docs/strong">Banning untyped</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Editor Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/lsp">Language Server (LSP)</a></li><li class="navListItem"><a class="navItem" href="/docs/server-status">Server Status</a></li><li class="navListItem"><a class="navItem" href="/docs/lsp-typed-level">LSP &amp; Typed Level</a></li><li class="navListItem"><a class="navItem" href="/docs/go-to-def">Go to Definition</a></li><li class="navListItem"><a class="navItem" href="/docs/hover">Hover</a></li><li class="navListItem"><a class="navItem" href="/docs/autocompletion">Autocompletion</a></li><li class="navListItem"><a class="navItem" href="/docs/references">Find All References</a></li><li class="navListItem"><a class="navItem" href="/docs/code-actions">Code Actions</a></li><li class="navListItem"><a class="navItem" href="/docs/outline">Outline &amp; Document Symbols</a></li><li class="navListItem"><a class="navItem" href="/docs/doc-comments">Documentation Comments</a></li><li class="navListItem"><a class="navItem" href="/docs/sig-suggestion">Suggesting sigs</a></li><li class="navListItem"><a class="navItem" href="/docs/highlight-untyped">Highlighting untyped</a></li><li class="navListItem"><a class="navItem" href="/docs/sorbet-uris">sorbet: URIs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Experimental Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/tuples">Tuples</a></li><li class="navListItem"><a class="navItem" href="/docs/shapes">Shapes</a></li><li class="navListItem"><a class="navItem" href="/docs/overloads">Overloads</a></li><li class="navListItem"><a class="navItem" href="/docs/requires-ancestor">Requiring Ancestors</a></li><li class="navListItem"><a class="navItem" href="/docs/rbs-support">RBS Comments</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/sorbet/sorbet/edit/master/website/docs/faq.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Frequently Asked Questions</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not"></a><a href="#why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why does Sorbet think this is <code>nil</code>? I just checked that it’s not!</h2>
<p>Sorbet implements a <a href="/docs/flow-sensitive">flow-sensitive</a> type system, but there are some <a href="/docs/flow-sensitive#limitations-of-flow-sensitivity">limitations</a>. In particular, Sorbet does not assume a method called twice returns the same thing each time!</p>
<p>See <a href="/docs/flow-sensitive#limitations-of-flow-sensitivity">Limitations of flow-sensitivity</a> for a fully working example.</p>
<h2><a class="anchor" aria-hidden="true" id="it-looks-like-sorbets-types-for-the-stdlib-are-wrong"></a><a href="#it-looks-like-sorbets-types-for-the-stdlib-are-wrong" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>It looks like Sorbet’s types for the stdlib are wrong.</h2>
<p>Sorbet uses <a href="/docs/rbi">RBI files</a> to annotate the types for the Ruby standard library. Every RBI file for the Ruby standard library is maintained by hand. This means they’re able to have fine grained types, but it also means that sometimes they’re incomplete or inaccurate.</p>
<p>The Sorbet team is usually too busy to respond to requests to fix individual bugs in these type annotations for the Ruby standard library. That means there are two options:</p>
<ol>
<li><p>Submit a pull request to fix the type annotations yourself.</p>
<p>Every RBI file for the Ruby standard library lives <a href="https://github.com/sorbet/sorbet/tree/master/rbi">here</a> in the Sorbet repo. Find which RBI file you need to edit, and submit a pull request on GitHub with the changes.</p>
<p>This is the preferred option, because then every Sorbet user will benefit.</p></li>
<li><p>Use an <a href="/docs/troubleshooting#escape-hatches">escape hatch</a> to opt out of static type checks.</p>
<p>Use this option if you can’t afford to wait for Sorbet to be fixed and published. (Sorbet publishes new versions to RubyGems nightly).</p></li>
</ol>
<p>If you’re having problems making a change to Sorbet, we’re happy to help on Slack! See the <a href="/community">Community</a> page for an invite link.</p>
<p>Be sure to also check out our <a href="/docs/rbi#versioning-for-standard-library-rbis">Versioning policy for standard library RBIs</a>, which basically says that in general, Sorbet’s RBIs for the standard library aim to be a superset of everything that gem defines (past and present).</p>
<h2><a class="anchor" aria-hidden="true" id="whats-the-difference-between-tlet-tcast-and-tunsafe"></a><a href="#whats-the-difference-between-tlet-tcast-and-tunsafe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the difference between <code>T.let</code>, <code>T.cast</code>, and <code>T.unsafe</code>?</h2>
<p><a href="/docs/type-assertions">→ Type Assertions</a></p>
<h2><a class="anchor" aria-hidden="true" id="whats-the-type-signature-for-a-method-with-no-return"></a><a href="#whats-the-type-signature-for-a-method-with-no-return" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the type signature for a method with no return?</h2>
<pre><code class="hljs css language-ruby">sig { void }
</code></pre>
<p><a href="/docs/sigs">→ Method Signatures</a></p>
<h2><a class="anchor" aria-hidden="true" id="whats-the-signature-for-a-method-that-returns-multiple-values"></a><a href="#whats-the-signature-for-a-method-that-returns-multiple-values" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the signature for a method that returns multiple values?</h2>
<p>Ruby’s <code>return x, y</code> syntax is just shorthand for <code>return [x, y]</code>.</p>
<p>For methods using this multiple return shorthand, the return type should be either:</p>
<ul>
<li><p>an <a href="/docs/stdlib-generics">Array</a></p>
<pre><code class="hljs css language-ruby">sig { <span class="hljs-keyword">return</span>(T::Array[Integer]) }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">example</span></span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">2</span>
<span class="hljs-keyword">end</span>
</code></pre></li>
<li><p>a <a href="/docs/tuples">Tuple</a> (experimental)</p>
<pre><code class="hljs css language-ruby">sig { <span class="hljs-keyword">return</span>([Integer, String]) }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">example</span></span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-string">''</span>
<span class="hljs-keyword">end</span>
</code></pre></li>
</ul>
<p><a href="/docs/sigs">→ Method Signatures</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-should-i-add-types-to-methods-defined-with-attr_reader"></a><a href="#how-should-i-add-types-to-methods-defined-with-attr_reader" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How should I add types to methods defined with <code>attr_reader</code>?</h2>
<p>Sorbet has special knowledge for <code>attr_reader</code>, <code>attr_writer</code>, and <code>attr_accessor</code>. To add types to methods defined with any of these helpers, put a <a href="/docs/sigs">method signature</a> above the declaration, just like any other method:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># typed: true</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>
  extend T::Sig

  sig { returns(Integer) }
  <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:reader</span>

  sig { params(<span class="hljs-symbol">writer:</span> Integer).returns(Integer) }
  <span class="hljs-keyword">attr_writer</span> <span class="hljs-symbol">:writer</span>

  <span class="hljs-comment"># For attr_accessor, write the sig for the reader portion.</span>
  <span class="hljs-comment"># (Sorbet will use that to write the sig for the writer portion.)</span>
  sig { returns(Integer) }
  <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:accessor</span>

  sig { void }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
    @reader = T.let(<span class="hljs-number">0</span>, Integer)
    @writer = T.let(<span class="hljs-number">0</span>, Integer)
    @accessor = T.let(<span class="hljs-number">0</span>, Integer)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><a href="https://sorbet.run/#%23%20typed%3A%20true%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_reader%20%3Areader%0A%0A%20%20sig%20%7Bparams(writer%3A%20Integer).returns(Integer)%7D%0A%20%20attr_writer%20%3Awriter%0A%0A%20%20%23%20For%20attr_accessor%2C%20write%20the%20sig%20for%20the%20reader%20portion.%0A%20%20%23%20(Sorbet%20will%20use%20that%20to%20write%20the%20sig%20for%20the%20writer%20portion.)%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Aaccessor%0Aend">→ View on sorbet.run</a></p>
<blockquote>
<p>Because Sorbet knows what <code>attr_*</code> methods define what instance variables, in <code>typed: strict</code> there are some gotchas that apply (which are the same for <a href="/docs/type-annotations">all other uses</a> of instance variables): in order to use an instance variable, it must be initialized in the constructor, or be marked <a href="/docs/nilable-types">nilable</a> (<code>T.nilable(...)</code>).</p>
<p>(<a href="https://sorbet.run/#%23%20typed%3A%20strict%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_reader%20%3Areader%0A%0A%20%20sig%20%7Bparams(writer%3A%20Integer).returns(Integer)%7D%0A%20%20attr_writer%20%3Awriter%0A%0A%20%20%23%20For%20attr_accessor%2C%20write%20the%20sig%20for%20the%20reader%20portion.%0A%20%20%23%20(Sorbet%20will%20use%20that%20to%20write%20the%20sig%20for%20the%20writer%20portion.)%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Aaccessor%0A%0A%20%20sig%20%7Bparams(reader%3A%20Integer%2C%20writer%3A%20Integer%2C%20accessor%3A%20Integer).void%7D%0A%20%20def%20initialize(reader%2C%20writer%2C%20accessor)%0A%20%20%20%20%40reader%20%3D%20reader%0A%20%20%20%20%40writer%20%3D%20writer%0A%20%20%20%20%40accessor%20%3D%20accessor%0A%20%20end%0Aend">→ Full example on sorbet.run</a>)</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="whats-the-difference-between-array-and-tarray"></a><a href="#whats-the-difference-between-array-and-tarray" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the difference between <code>Array</code> and <code>T::Array[…]</code>?</h2>
<p><code>Array</code> is the built-in Ruby class for arrays. On the other hand, <code>T::Array[...]</code> is a Sorbet generic type for arrays. The <code>...</code> must always be filled in when using it.</p>
<p>While Sorbet implicitly treats <code>Array</code> the same as <code>T::Array[T.untyped]</code>, Sorbet will error when trying to use <code>T::Array</code> as a standalone type.</p>
<p><a href="/docs/stdlib-generics">→ Generics in the Standard Library</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-accept-a-class-object-and-not-an-instance-of-a-class"></a><a href="#how-do-i-accept-a-class-object-and-not-an-instance-of-a-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I accept a class object, and not an instance of a class?</h2>
<p><a href="/docs/class-of">→ T.class_of</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-write-a-signature-for-initialize"></a><a href="#how-do-i-write-a-signature-for-initialize" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I write a signature for <code>initialize</code>?</h2>
<p>When defining <code>initialize</code> for a class, we strongly encourage that you use <code>.void</code>. This reminds people instantiating your class that they probably meant to call <code>.new</code>, which is defined on every Ruby class. Typing the result as <code>.void</code> means that it’s not possible to do anything with the result of <code>initialize</code>.</p>
<p><a href="/docs/sigs">→ Method Signatures</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-override--what-signature-should-i-use"></a><a href="#how-do-i-override--what-signature-should-i-use" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I override <code>==</code>? What signature should I use?</h2>
<p>The same suggestions also apply for overriding <code>eql?</code>. <code>==</code> is typically used for custom/structural equality operators. <code>eql?</code> is typically used for reference equality. But from the perspective of the type system, they both have the same signature.</p>
<p>Your method should accept <code>T.anything</code> and return <code>T::Boolean</code>. For more information, see the docs for <a href="/docs/anything"><code>T.anything</code></a> and the blog post <a href="https://blog.jez.io/problems-typing-ruby-equality/">Problems typing equality in Ruby</a>.</p>
<p>If you want the implementation to branch on the type of the argument, you’ll want to use <code>case</code>/<code>when</code> (or <code>Module#===</code> directly) instead of <code>is_a?</code>.</p>
<p>Example using <code>case</code>/<code>when</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>
  <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:foo</span>

  sig { params(<span class="hljs-symbol">other:</span> T.anything).returns(T::Boolean) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">==</span><span class="hljs-params">(other)</span></span>
    <span class="hljs-keyword">case</span> other
    <span class="hljs-keyword">when</span> A
      <span class="hljs-keyword">self</span>.foo == other.foo
    <span class="hljs-keyword">else</span>
      <span class="hljs-literal">false</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Example using <a href="https://stackoverflow.com/questions/3422223/vs-in-ruby"><code>===</code> directly</a>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>
  <span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:foo</span>

  sig { params(<span class="hljs-symbol">other:</span> T.anything).returns(T::Boolean) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">==</span><span class="hljs-params">(other)</span></span>
    (A === other) &amp;&amp; (<span class="hljs-keyword">self</span>.foo == other.foo)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this"></a><a href="#i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I use <code>T.must</code> a lot with arrays and hashes. Is there a way around this?</h2>
<p><code>Hash#[]</code> and <code>Array#[]</code> return a <a href="/docs/nilable-types">nilable type</a> because in Ruby, accessing a Hash or Array returns <code>nil</code> if the key does not exist or is out-of-bounds. If you would rather raise an exception than handle <code>nil</code>, use the <code>#fetch</code> method:</p>
<pre><code class="hljs css language-ruby">[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>].fetch(<span class="hljs-number">3</span>) <span class="hljs-comment"># IndexError: index 3 outside of array bounds</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types"></a><a href="#sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sigs are vague for stdlib methods that accept keyword arguments &amp; have multiple return types</h2>
<p>You might notice this when calling <code>Array#sample</code>, <code>Pathname#find</code>, or other stdlib methods that accept a keyword argument and can have different return types based on arguments:</p>
<pre><code class="hljs css language-ruby">T.reveal_type([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].sample) <span class="hljs-comment"># Revealed type: T.nilable(T.any(Integer, T::Array[Integer]))</span>
</code></pre>
<p>The sig in Sorbet’s stdlib is quite wide, since it has to cover every possible return type. Sorbet does not have good support for this for methods that accept keyword arguments. <a href="https://github.com/sorbet/sorbet/issues/37">#37</a> is the original report of this. <a href="https://github.com/sorbet/sorbet/pull/2248#issuecomment-562728417">#2248</a> has an explanation of why this is hard to fix in Sorbet.</p>
<p>To work around this, you’ll need to use <code>T.cast</code>.</p>
<pre><code class="hljs css language-ruby">item = T.cast([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].sample, Integer)
T.reveal_type(item) <span class="hljs-comment"># Revealed type: Integer</span>
</code></pre>
<p>In some cases - for example, with complex number conversion methods in <code>Kernel</code> - the Sorbet team has chosen to ship technically incorrect RBIs that are much more pragmatic. See <a href="https://github.com/sorbet/sorbet/pull/1144">#1144</a> for an example. You can do the same for other cases you find annoying, but you take on the risk of always need to call the method correctly based on your new sig.</p>
<p>For example, if you are confident you’ll never call <code>Array#sample</code> on an empty array, use this <a href="/docs/rbi">RBI</a> to not have to worry about <code>nil</code> returns.</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig <span class="hljs-keyword">do</span>
    params(<span class="hljs-symbol">arg0:</span> Integer, <span class="hljs-symbol">random:</span> Random::Formatter)
    .returns(T.any(Elem, T::Array[Elem]))
  <span class="hljs-keyword">end</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample</span><span class="hljs-params">(arg<span class="hljs-number">0</span>=T.unsafe(<span class="hljs-literal">nil</span>)</span></span>, <span class="hljs-symbol">random:</span> T.unsafe(<span class="hljs-literal">nil</span>)); <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Or if you never call it with an argument (you always do <code>[1,2,3].sample</code>, never <code>[1,2,3].sample(2)</code>), use this RBI to always get an element (not an array) as your return type:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig <span class="hljs-keyword">do</span>
    params(<span class="hljs-symbol">arg0:</span> Integer, <span class="hljs-symbol">random:</span> Random::Formatter)
    .returns(Elem) <span class="hljs-comment"># or T.nilable(Elem), to also support empty arrays</span>
  <span class="hljs-keyword">end</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample</span><span class="hljs-params">(arg<span class="hljs-number">0</span>=T.unsafe(<span class="hljs-literal">nil</span>)</span></span>, <span class="hljs-symbol">random:</span> T.unsafe(<span class="hljs-literal">nil</span>)); <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<blockquote>
<p>Overriding stdlib RBIs can make type checking less safe, since Sorbet will now have an incorrect understanding of how the stdlib behaves.</p>
</blockquote>
<p>Another alternative is to define new methods that are stricter about arguments, and use these in place of stdlib methods:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig { returns(Elem) } <span class="hljs-comment"># or T.nilable(Elem) unless you're confident this is never called on empty arrays</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample_one</span></span>
    T.cast(sample, Elem)
  <span class="hljs-keyword">end</span>

  sig { params(<span class="hljs-symbol">n:</span> Integer).returns(T::Array[Elem]) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample_n</span><span class="hljs-params">(n)</span></span>
    T.cast(sample(n), T::Array[Elem])
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="why-is-super-untyped-even-when-the-parent-method-has-a-sig"></a><a href="#why-is-super-untyped-even-when-the-parent-method-has-a-sig" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why is <code>super</code> untyped, even when the parent method has a <code>sig</code>?</h2>
<p>By default, Sorbet type checks all calls to <code>super</code> that it can, but there are still cases where it can’t statically check calls to <code>super</code>.</p>
<p>See below.</p>
<p>Note that like with most parts of Sorbet, support for typing <code>super</code> is expected to improve over time, which might introduce new type errors upon upgrading to a newer Sorbet version.</p>
<h2><a class="anchor" aria-hidden="true" id="when-are-calls-to-super-typed-and-when-are-they-untyped"></a><a href="#when-are-calls-to-super-typed-and-when-are-they-untyped" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When are calls to <code>super</code> typed, and when are they untyped?</h2>
<p>Over time, we have improved support for <code>super</code> in certain circumstances. In particular, if all of these things are true, Sorbet will type check the call to <code>super</code>:</p>
<ul>
<li><p>The usage of <code>super</code> must be in a method defined in a <code>class</code>, not a module.</p>
<p>(Why? → Inside a module, the method that <code>super</code> dispatches to <a href="https://sorbet.run/#%23%20typed%3A%20true%0Amodule%20MyModule%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns%28Integer%29%7D%0A%20%20def%20foo%0A%20%20%20%20%23%20Can't%20know%20super%20until%20we%20know%20which%20module%20we're%20mixed%20into%0A%20%20%20%20res%20%3D%20super%0A%20%20%20%20T.reveal_type%28res%29%0A%20%20%20%20res%0A%20%20end%0Aend%0A%0Amodule%20ParentModule1%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns%28Integer%29%7D%0A%20%20def%20foo%0A%20%20%20%200%0A%20%20end%0Aend%0A%0Amodule%20ParentModule2%0A%20%20extend%20T%3A%3ASig%0A%20%20%0A%20%20sig%20%7Breturns%28String%29%7D%0A%20%20def%20foo%0A%20%20%20%20''%0A%20%20end%0Aend%0A%0Aclass%20MyClass1%0A%20%20include%20ParentModule1%0A%20%20include%20MyModule%0Aend%0A%0Aclass%20MyClass2%0A%20%20include%20ParentModule2%0A%20%20include%20MyModule%0Aend%0A%0AMyClass1.new.foo%0AMyClass2.new.foo%0A">is different each time</a> the module is mixed into a different class. This means there’s not necessarily a single way to analyze a call to <code>super</code> statically.)</p></li>
<li><p>The usage of <code>super</code> must not be inside a Ruby block (like <code>do ... end</code>)</p>
<p>(Why? → Sorbet doesn’t always know whether the block is being passed to <code>define_method</code>, or otherwise <a href="https://sorbet.run/#%23%20typed%3A%20strict%0A%0Aclass%20Parent%0A%20%20extend%20T%3A%3ASig%0A%20%20sig%20%7Breturns%28Integer%29%7D%0A%20%20def%20self.foo%0A%20%20%20%200%0A%20%20end%0A%0A%20%20sig%20%7Breturns%28String%29%7D%0A%20%20def%20self.bar%0A%20%20%20%20''%0A%20%20end%0Aend%0A%0Aclass%20Child%20%3C%20Parent%0A%20%20sig%20%7Breturns%28Integer%29%7D%0A%20%20def%20self.foo%0A%20%20%20%20define_method%28%3Abar%29%20do%0A%20%20%20%20%20%20x%20%3D%20super%0A%20%20%20%20%20%20T.reveal_type%28x%29%0A%20%20%20%20%20%20%23%20-%3E%20should%20reveal%20String%2C%20but%20Sorbet%20doesn't%20know%20that%0A%20%20%20%20end%0A%0A%20%20%20%200%0A%20%20end%0Aend">executed in a context different from the enclosing context</a>.)</p></li>
</ul>
<p>To opt out of type checking <code>super</code>, pass the <code>--typed-super=false</code> command line flag to Sorbet.</p>
<h2><a class="anchor" aria-hidden="true" id="how-can-i-fix-type-errors-that-arise-from-super"></a><a href="#how-can-i-fix-type-errors-that-arise-from-super" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How can I fix type errors that arise from <code>super</code>?</h2>
<ol>
<li><p>“Method does not exist” type errors can happen when Sorbet does not see that a method with the same name actually exists on an ancestor of the current class. Double check whether such a method actually exist. If it does, metaprogramming is likely hiding that definition from Sorbet. Use <a href="/docs/rbi">RBI files</a> to ensure that Sorbet sees the parent’s definition.</p></li>
<li><p>Usually type errors from <code>super</code> arise because of incompatible overrides, <a href="https://sorbet.run/#%23%20typed%3A%20strict%0A%0Aclass%20Parent%0A%20%20extend%20T%3A%3ASig%0A%20%20sig%20%7Breturns%28Integer%29%7D%0A%20%20def%20self.foo%0A%20%20%20%200%0A%20%20end%0Aend%0A%0Aclass%20Child%20%3C%20Parent%0A%20%20sig%20%7Breturns%28String%29%7D%0A%20%20def%20self.foo%0A%20%20%20%20super%0A%20%20end%0Aend">like this</a>. Sorbet only does <a href="/docs/override-checking">Override Checking</a> when the parent method is declared with <code>overridable</code> or <code>abstract</code>, which means that incompatible overrides can creep into a codebase.</p>
<p>To fix these errors, correct the signature so that the child signature is a <a href="/docs/override-checking#a-note-on-variance">valid override</a>.</p></li>
<li><p>Sometimes the type errors happen even when the child is a valid override of the parent, because the child either promises to accept a wider input or return a narrower output. In these cases, before and/or after calling <code>super</code>, the child method will need to handle the cases that the parent method’s type is unable to handle. (Or, if possible: adjust the parent’s signature to match the child’s signature.)</p></li>
<li><p>All <code>initialize</code> calls in Sorbet are typed as returning <code>.void</code>, regardless of what they actually return. Usually, calls to <code>initialize</code> simply return <code>self</code>. So instead of doing this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
  <span class="hljs-keyword">super</span>.foo
<span class="hljs-keyword">end</span>
</code></pre>
<p>do this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
  <span class="hljs-keyword">super</span>
  <span class="hljs-keyword">self</span>.foo
<span class="hljs-keyword">end</span>
</code></pre></li>
<li><p>Unlike method calls, it’s <strong>not possible</strong> to do something like <code>T.unsafe(self).super</code> to silence errors from a single usage of <code>super</code> (<code>super</code> is a keyword in Ruby, not a method call).</p>
<p>This means that there is not a way to silence errors from a single usage of <code>super</code>. The best you can do is silence all errors inside a method using <code>T.bind</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">example</span></span>
  T.bind(<span class="hljs-keyword">self</span>, T.untyped) <span class="hljs-comment"># &lt;------</span>
  <span class="hljs-keyword">super</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>See the docs for <a href="/docs/procs#casting-the-self-type-with-tbind">T.bind</a>. Note: not only does this opt out of typechecking calls to <code>super</code>, but it also opts out of type checking for all method calls on <code>self</code> in that method body.</p></li>
<li><p>To silence all type errors from super, use the <code>--typed-super=false</code> flag. This opts out of all <code>super</code> type checking.</p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="why-does-tuntyped--tboolean-have-type-tnilabletboolean"></a><a href="#why-does-tuntyped--tboolean-have-type-tnilabletboolean" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why does <code>T.untyped &amp;&amp; T::Boolean</code> have type <code>T.nilable(T::Boolean)</code>?</h2>
<p><strong>The short answer</strong>: because <code>T.untyped</code> includes <code>nil</code>, and <code>nil &amp;&amp; false</code> is <code>nil</code>. Therefore, the whole expression’s type is possibly nilable.</p>
<p><strong>The long answer</strong>: given a snippet like this</p>
<pre><code class="hljs css language-ruby">sig { params(<span class="hljs-symbol">x:</span> T.untyped, <span class="hljs-symbol">y:</span> T::Boolean).void }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">example</span><span class="hljs-params">(x, y)</span></span>
  res = x &amp;&amp; y
  T.reveal_type(res) <span class="hljs-comment"># =&gt; T.nilable(T::Boolean)</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>The revealed type is <a href="/docs/nilable-types"><code>T.nilable</code></a> despite neither <code>x</code> nor <code>y</code> being <code>T.nilable</code>. Ruby’s <code>&amp;&amp;</code> operator is short-circuiting, and <code>nil</code> is falsy:</p>
<pre><code class="hljs css language-ruby">x = <span class="hljs-literal">nil</span> &amp;&amp; anything_else()
p(x) <span class="hljs-comment"># =&gt; nil</span>
</code></pre>
<p>This <code>&amp;&amp;</code> expression evaluates to <code>nil</code> without evaluating <code>anything_else()</code>.</p>
<p>So thinking about our <code>res = x &amp;&amp; y</code> expression:</p>
<ol>
<li>If <code>x</code> is <code>nil</code>, the whole expression is <code>nil</code> and the type must be at least <a href="/docs/class-types#nil"><code>NilClass</code></a>.</li>
<li>If <code>x</code> is <code>false</code>, the whole expression’s type must be at least <a href="/docs/class-types#booleans"><code>FalseClass</code></a>.</li>
<li>Otherwise, <code>x</code> is truthy (only <code>nil</code> and <code>false</code> are falsy in Ruby), so the expression evaluates to the value of <code>y</code>, assuming it’s type. In this case, <code>T::Boolean</code>.</li>
</ol>
<p>Therefore, the type is <code>T.any(NilClass, FalseClass, T::Boolean)</code> which simplifies to <code>T.nilable(T::Boolean)</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="does-sorbet-work-with-rake-and-rakefiles"></a><a href="#does-sorbet-work-with-rake-and-rakefiles" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Does Sorbet work with Rake and Rakefiles?</h2>
<p>Kind of, with some effort. Rake monkey patches the global <code>main</code> object (i.e., top-level code) to extend their DSL, which Sorbet cannot understand:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># -- from lib/rake/dsl_definition.rb --</span>

...

<span class="hljs-comment"># Extend the main object with the DSL commands. This allows top-level</span>
<span class="hljs-comment"># calls to task, etc. to work from a Rakefile without polluting the</span>
<span class="hljs-comment"># object inheritance tree.</span>
<span class="hljs-keyword">self</span>.extend Rake::DSL
</code></pre>
<p>→ <a href="https://github.com/ruby/rake/blob/80e00e2d59ea5b230f2f0416c387c0b57184f1ff/lib/rake/dsl_definition.rb#L192-L195">lib/rake/dsl_definition.rb</a></p>
<p>Sorbet cannot model that a single instance of an object (in this case <code>main</code>) has a different inheritance hierarchy than that instance’s class (in this case <code>Object</code>).</p>
<p>To get around this, factor out all tasks defined the <code>Rakefile</code> that should be typechecked into an explicit class in a separate file, something like this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># -- my_rake_tasks.rb --</span>

<span class="hljs-comment"># (1) Make a proper class inside a file with a *.rb extension</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRakeTasks</span></span>
  <span class="hljs-comment"># (2) Explicitly extend Rake::DSL in this class</span>
  extend Rake::DSL

  <span class="hljs-comment"># (3) Define tasks like normal:</span>
  task <span class="hljs-symbol">:test</span> <span class="hljs-keyword">do</span>
    puts <span class="hljs-string">'Testing...'</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment"># ... more tasks ...</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># -- Rakefile --</span>

<span class="hljs-comment"># (4) Require that file from the Rakefile</span>
require_relative <span class="hljs-string">'./my_rake_tasks'</span>
</code></pre>
<p>For more information, see <a href="https://stackoverflow.com/a/60556206/1015863">this StackOverflow question</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-upgrade-sorbet"></a><a href="#how-do-i-upgrade-sorbet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I upgrade Sorbet?</h2>
<p>Sorbet has not reached version 1.0 yet. As such, it will make breaking changes constantly, without warning.</p>
<p>To upgrade a patch level (e.g., from 0.4.4314 to 0.4.4358):</p>
<pre><code class="hljs css language-bash">bundle update sorbet sorbet-runtime
<span class="hljs-comment"># also update plugins, if any</span>

<span class="hljs-comment"># Optional: Suggest new, stronger sigils (per-file strictness</span>
<span class="hljs-comment"># levels) when possible. Currently, the suggestion process is</span>
<span class="hljs-comment"># fallible, and may suggest downgrading when it's not necessary.</span>
bundle <span class="hljs-built_in">exec</span> srb rbi suggest-typed
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="what-platforms-does-sorbet-support"></a><a href="#what-platforms-does-sorbet-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What platforms does Sorbet support?</h2>
<p>The <code>sorbet-runtime</code> gem is tested on <a href="https://github.com/sorbet/sorbet/blob/master/.buildkite/build-sorbet-runtime.sh#L10">these Ruby versions</a>. Importantly, <code>sorbet-runtime</code> no longer supports Ruby 2.6, which is the last version before <a href="https://docs.ruby-lang.org/en/3.3/UnboundMethod.html#method-i-bind_call">the <code>bind_call</code> method</a> was added, which substantially improves the speed of <code>sorbet-runtime</code>. More recent versions of Ruby than <code>sorbet-runtime</code> is tested against usually also work fine. Feel free to report runtime issues for any current or future Ruby version.</p>
<p>The <code>sorbet-static</code> gem is known to support Ruby versions as far back as 2.4. The Ruby language itself (ignoring the standard library) rarely removes features, which means that Sorbet typically does not drop support for old Ruby versions. However, Sorbet does not attempt to warn when a project is using newer Ruby syntax but will run on an older Ruby version: if a project is using new syntax, Sorbet assumes it will run with a new enough version of Ruby. Other tools (for example Rubocop) can validate whether a project is using incorrect syntax for a given Ruby version.</p>
<p>Some language features are typed more strictly than others (generally, language features in newer Ruby versions have looser type support). This is not by design, just a matter of priorities. Feel free to open feature requests that various (new or old) language features be typed more strictly.</p>
<p>Sorbet bundles <a href="/docs/rbi">RBI files</a> for the standard library. In Ruby the standard library changes with the Ruby version being used, but Sorbet only ships one set of RBI definitions for the standard library. In particular, Sorbet’s RBI files for the standard library might reflect classes, methods, or APIs that are only available in a version of Ruby newer than the one used to run a given project. You will have to rely on (runtime) test suites to verify that your project does not use new standard library APIs with an old Ruby version, or does not use removed standard library APIs with a new Ruby version.</p>
<p>The <code>sorbet-static</code> gem is only tested on macOS 10.14 (Mojave), macOS 15.0 (Sequoia) on Apple Silicon, and Ubuntu 18 (Bionic Beaver). There is currently no Windows support. We expect <code>sorbet-static</code> to work as far back as macOS 10.10 (Yosemite) and on most Linux distributions using <code>glibc</code>.</p>
<p>Starting from version 0.5.11577, Sorbet provides tested and prebuilt binaries for macOS on Apple Silicon. If you encounter bugs, please <a href="https://github.com/sorbet/sorbet/issues/new/choose">open an issue</a>. Otherwise, feel free to discuss this change in the #discuss channel on our <a href="/slack">Sorbet Slack</a>.</p>
<p>The <code>sorbet</code> gem has runtime dependencies on <code>git</code> and <code>bash</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="does-sorbet-support-activerecord-and-rails"></a><a href="#does-sorbet-support-activerecord-and-rails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Does Sorbet support ActiveRecord (and Rails?)</h2>
<p>Sorbet doesn’t support Rails, but <a href="https://github.com/Shopify/tapioca#generating-rbi-files-for-rails-and-other-dsls">Tapioca can generate RBI files for it</a>.</p>
<p>Also see the <a href="/en/community">Community</a> page for more community-maintained projects!</p>
<h2><a class="anchor" aria-hidden="true" id="can-i-convert-from-yard-docs-to-sorbet-signatures"></a><a href="#can-i-convert-from-yard-docs-to-sorbet-signatures" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Can I convert from YARD docs to Sorbet signatures?</h2>
<p><a href="https://github.com/AaronC81/sord">Sord</a> is a community-maintained project which can generate Sorbet RBI files from YARD docs.</p>
<p>Also see the <a href="/en/community">Community</a> page for more community-maintained projects!</p>
<h2><a class="anchor" aria-hidden="true" id="when-ruby-3-gets-types-what-will-the-migration-plan-look-like"></a><a href="#when-ruby-3-gets-types-what-will-the-migration-plan-look-like" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When Ruby 3 gets types, what will the migration plan look like?</h2>
<p>The Sorbet team is actively involved in the Ruby 3 working group for static typing. There are some things we know and something we don’t know about Ruby 3.</p>
<p>Ruby 3 plans to ship type annotations for the standard library. These type annotations for the standard library will live in separate Ruby Signature (RBS) files, with the <code>*.rbs</code> extension. The exact syntax is not yet finalized. When the syntax is finalized, Sorbet intends to ingest both RBS and RBI formats, so that users can choose their favorite.</p>
<p>Ruby 3 has no plans to change Ruby’s syntax. To have type annotations for methods live in the same place as the method definition, the only option will be to continue using Sorbet’s <a href="/docs/sigs">method signatures</a>. As such, the Sorbet docs will always use RBI syntax in examples, because the syntax is the same for signatures both within a Ruby file and in external <a href="/docs/rbi">RBI files</a>.</p>
<p>Ruby 3 has no plans to ship a type checker for RBS annotations. Instead, Ruby 3 plans to ship a type profiler, which will attempt to guess signatures for code without signatures. The only way to get type checking will be to use third party tools, like Sorbet.</p>
<p>Ruby 3 plans to ship no specification for what the type annotations mean. Each third party type checker and the Ruby 3 type profiler will be allowed to ascribe their own meanings to individual type annotations. When there are ambiguities or constructs that one tool doesn’t understand, it should fall back to <code>T.untyped</code> (or the equivalent in whatever RBS syntax decides to use for <a href="/docs/untyped">this construct</a>).</p>
<p>Ruby 3 plans to seed the initial type annotations for the standard library from Sorbet’s extensive existing type annotations for the standard library. Sorbet already has great type annotations for the standard library in the form of <a href="/docs/rbi">RBI files</a> which are used to type check millions of lines of production Ruby code every day.</p>
<p>From all of this, we have every reason to believe that users of Sorbet will have a smooth transition to Ruby 3:</p>
<ul>
<li>You will be able to either keep using Sorbet’s RBI syntax or switch to using RBS syntax.</li>
<li>The type definitions for the standard library will mean the same (because they will have come from Sorbet!) but have a different syntax.</li>
<li>For inline type annotations with Ruby 3, you will have to continue using Sorbet’s <code>sig</code> syntax, no different from today.</li>
</ul>
<p>For more information, watch <a href="https://youtu.be/2g9R7PUCEXo?t=2022">this section</a> from Matz’s RubyConf 2019 keynote, which talks about his plans for typing in Ruby 3.</p>
<blockquote>
<p><strong>February 2025 update</strong>: We’re experimenting with limited support for RBS signatures as comments. This feature is protected by the <code>--enable-experimental-rbs-comments</code> flag. See the <a href="/docs/rbs-support">RBS support</a> page for more details.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="can-i-use-sorbet-for-duck-typed-code"></a><a href="#can-i-use-sorbet-for-duck-typed-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Can I use Sorbet for duck typed code?</h2>
<p>No. You can use an <a href="/docs/abstract">interface</a> instead, or <code>T.untyped</code> if you do not control all of the code.</p>
<p>Duck typing (or, more formally, Structural typing) specifies types by their structure. For example, Rack middleware accepts any object that has a <code>call</code> method which takes one argument and returns a tuple representing an HTTP response.</p>
<p>Sorbet does not support duck typing either for static analysis or runtime checking.</p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-see-errors-from-a-single-file-not-the-whole-project"></a><a href="#how-do-i-see-errors-from-a-single-file-not-the-whole-project" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I see errors from a single file, not the whole project?</h2>
<p>Fundamentally, Sorbet typechecks a single project at a time. Unlike other languages and compilers, it does not process files in a codebase one file at a time. This is largely due to the fact that Ruby does not have any sort of file-level import mechanism—in Ruby, code can usually be defined anywhere and used from anywhere else—and this places constraints on how Sorbet must be implemented.</p>
<p>Because Sorbet typechecks a single project at a time, it does not allow filtering the list of errors to a single file. Sometimes though, the number of errors Sorbet reports can be overwhelming, especially when adopting Sorbet in a new codebase. In these cases, the best way to proceed is as follows:</p>
<ol>
<li><p>Put every file in the codebase at <code># typed: false</code> (see <a href="/docs/static#file-level-granularity-strictness-levels">Strictness Levels</a>). Note that the default strictness level when there is no explicit <code># typed:</code> comment in a file is <code># typed: false</code>. The <code>--typed=false</code> command line flag can be used to forcibly override every file’s strictness level to <code># typed: false</code>, regardless of what’s written in the file.</p>
<p>Forcing every file to <code># typed: false</code> will silence all but the most critical Sorbet errors throughout the project.</p></li>
<li><p>Proceed to fix these errors. If there are still an overwhelming number of errors, tackle the errors that are reported earlier first. Sorbet’s design means that errors discovered early in the early phases of typechecking can cause redundant errors in later phases.</p></li>
<li><p>Once there are no errors in any files at <code># typed: false</code>, proceed to upgrade individual files to <code># typed: true</code>. Only new errors will be reported in these <code># typed: true</code> files, and not in any other files. Repeatedly upgrade as many individual files as is preferred. Note that many Sorbet codebases start off with all files at <code># typed: false</code> and gradually (usually organically) shrink the number of <code># typed: false</code> files over time.</p></li>
</ol>
<p>If for some reason it’s still imperative to limit the Sorbet error output to only those errors coming from a single file and the steps above are not acceptable, we recommend post processing the errors reported by Sorbet with tools like <code>grep</code>.</p>
<p>There are also third-party tools that offer the ability to sort and filter Sorbet’s errors, like <a href="https://github.com/Shopify/spoom#errors-sorting-and-filtering">spoom</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="how-can-i-contribute-to-sorbet"></a><a href="#how-can-i-contribute-to-sorbet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How can I contribute to Sorbet?</h2>
<p>There are resources for what kinds of contributions we’re looking for help with, how best to communicate with the Sorbet team, and how to get started working in the Sorbet codebase on GitHub:</p>
<ul>
<li><p><a href="https://github.com/sorbet/sorbet/blob/master/CONTRIBUTING.md">CONTRIBUTING.md</a></p>
<p>A high-level guide we expect people to follow when contributing to Sorbet.</p>
<p>The biggest point is that we prefer people reach out to us before embarking on particularly large changes to Sorbet.</p></li>
<li><p><a href="https://github.com/sorbet/sorbet/blob/master/README.md">README.md</a></p>
<p>Extensive technical docs for how to build Sorbet, run tests and write new ones, learn about the architecture of Sorbet, and set up other aspects of Sorbet development.</p></li>
</ul>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/why-type-annotations"><span class="arrow-prev">← </span><span>Why type annotations?</span></a><a class="docs-next button" href="/docs/error-reference"><span>Error Reference</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not">Why does Sorbet think this is <code>nil</code>? I just checked that it's not!</a></li><li><a href="#it-looks-like-sorbets-types-for-the-stdlib-are-wrong">It looks like Sorbet's types for the stdlib are wrong.</a></li><li><a href="#whats-the-difference-between-tlet-tcast-and-tunsafe">What's the difference between <code>T.let</code>, <code>T.cast</code>, and <code>T.unsafe</code>?</a></li><li><a href="#whats-the-type-signature-for-a-method-with-no-return">What's the type signature for a method with no return?</a></li><li><a href="#whats-the-signature-for-a-method-that-returns-multiple-values">What's the signature for a method that returns multiple values?</a></li><li><a href="#how-should-i-add-types-to-methods-defined-with-attr_reader">How should I add types to methods defined with <code>attr_reader</code>?</a></li><li><a href="#whats-the-difference-between-array-and-tarray">What's the difference between <code>Array</code> and <code>T::Array[…]</code>?</a></li><li><a href="#how-do-i-accept-a-class-object-and-not-an-instance-of-a-class">How do I accept a class object, and not an instance of a class?</a></li><li><a href="#how-do-i-write-a-signature-for-initialize">How do I write a signature for <code>initialize</code>?</a></li><li><a href="#how-do-i-override--what-signature-should-i-use">How do I override <code>==</code>? What signature should I use?</a></li><li><a href="#i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this">I use <code>T.must</code> a lot with arrays and hashes. Is there a way around this?</a></li><li><a href="#sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types">Sigs are vague for stdlib methods that accept keyword arguments &amp; have multiple return types</a></li><li><a href="#why-is-super-untyped-even-when-the-parent-method-has-a-sig">Why is <code>super</code> untyped, even when the parent method has a <code>sig</code>?</a></li><li><a href="#when-are-calls-to-super-typed-and-when-are-they-untyped">When are calls to <code>super</code> typed, and when are they untyped?</a></li><li><a href="#how-can-i-fix-type-errors-that-arise-from-super">How can I fix type errors that arise from <code>super</code>?</a></li><li><a href="#why-does-tuntyped--tboolean-have-type-tnilabletboolean">Why does <code>T.untyped &amp;&amp; T::Boolean</code> have type <code>T.nilable(T::Boolean)</code>?</a></li><li><a href="#does-sorbet-work-with-rake-and-rakefiles">Does Sorbet work with Rake and Rakefiles?</a></li><li><a href="#how-do-i-upgrade-sorbet">How do I upgrade Sorbet?</a></li><li><a href="#what-platforms-does-sorbet-support">What platforms does Sorbet support?</a></li><li><a href="#does-sorbet-support-activerecord-and-rails">Does Sorbet support ActiveRecord (and Rails?)</a></li><li><a href="#can-i-convert-from-yard-docs-to-sorbet-signatures">Can I convert from YARD docs to Sorbet signatures?</a></li><li><a href="#when-ruby-3-gets-types-what-will-the-migration-plan-look-like">When Ruby 3 gets types, what will the migration plan look like?</a></li><li><a href="#can-i-use-sorbet-for-duck-typed-code">Can I use Sorbet for duck typed code?</a></li><li><a href="#how-do-i-see-errors-from-a-single-file-not-the-whole-project">How do I see errors from a single file, not the whole project?</a></li><li><a href="#how-can-i-contribute-to-sorbet">How can I contribute to Sorbet?</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div class="wrapper"><p class="footer"><svg width="99" height="28" viewBox="0 0 99 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.98432 20H6.27432C8.44932 20 9.81432 18.905 9.81432 17.03C9.81432 15.665 9.00432 14.72 7.78932 14.39C8.61432 14.105 9.45432 13.415 9.45432 12.035C9.45432 10.235 8.23932 9.23 5.95932 9.23H1.98432V20ZM3.37932 13.85V10.445H5.83932C7.27932 10.445 8.07432 11 8.07432 12.155C8.07432 13.295 7.27932 13.85 5.83932 13.85H3.37932ZM3.37932 15.08H6.21432C7.65432 15.08 8.43432 15.83 8.43432 16.925C8.43432 18.035 7.65432 18.785 6.21432 18.785H3.37932V15.08ZM18.0294 12.155H16.6794V16.88C16.6794 18.185 15.6894 18.92 14.7144 18.92C13.5594 18.92 13.0794 18.17 13.0794 17.06V12.155H11.7294V17.345C11.7294 19.01 12.6744 20.165 14.3544 20.165C15.4644 20.165 16.2294 19.58 16.6794 18.92V20H18.0294V12.155ZM20.5112 10.79H21.9812V9.23H20.5112V10.79ZM21.9212 12.155H20.5712V20H21.9212V12.155ZM25.8247 9.23H24.4747V20H25.8247V9.23ZM28.5882 18.125C28.5882 19.625 29.3532 20.075 30.6882 20.075C31.1382 20.075 31.5282 20.03 31.8732 19.955V18.8C31.5582 18.875 31.3332 18.89 31.0182 18.89C30.3282 18.89 29.9232 18.74 29.9232 17.915V13.31H31.7082V12.155H29.9232V9.86H28.5882V12.155H27.3732V13.31H28.5882V18.125ZM41.0199 20.165C43.1949 20.165 44.4399 18.305 44.4399 16.085C44.4399 13.85 43.1949 12.005 41.0199 12.005C39.9249 12.005 39.0549 12.53 38.5899 13.295V9.23H37.2399V20H38.5899V18.86C39.0549 19.64 39.9249 20.165 41.0199 20.165ZM38.5599 15.815C38.5599 13.985 39.6699 13.19 40.7799 13.19C42.2499 13.19 43.0749 14.39 43.0749 16.085C43.0749 17.765 42.2499 18.98 40.7799 18.98C39.6699 18.98 38.5599 18.17 38.5599 16.37V15.815ZM49.1804 20.855L52.5554 12.155H51.1454L48.9704 18.155L46.7654 12.155H45.3404L48.2504 19.715L47.8754 20.645C47.5604 21.425 47.2454 21.635 46.6604 21.635C46.4354 21.635 46.2704 21.62 46.0154 21.56V22.73C46.2554 22.775 46.4204 22.79 46.7504 22.79C48.1154 22.79 48.7304 22.04 49.1804 20.855Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M98.7993 15.7838C98.7993 12.8786 97.3871 10.5862 94.688 10.5862C91.9774 10.5862 90.3374 12.8786 90.3374 15.7611C90.3374 19.177 92.2735 20.9019 95.0524 20.9019C96.4077 20.9019 97.4327 20.5955 98.2071 20.1643V17.8946C97.4327 18.2804 96.5443 18.5188 95.4168 18.5188C94.3121 18.5188 93.3327 18.1329 93.2074 16.7938H98.7766C98.7766 16.6463 98.7993 16.0561 98.7993 15.7838ZM93.1732 14.7057C93.1732 13.4233 93.9591 12.8899 94.6766 12.8899C95.3713 12.8899 96.1116 13.4233 96.1116 14.7057H93.1732Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M85.9413 10.5862C84.8251 10.5862 84.1076 11.1082 83.709 11.4714L83.561 10.7678H81.0554V24.0001L83.9026 23.3986L83.914 20.187C84.324 20.482 84.9276 20.9019 85.9299 20.9019C87.9685 20.9019 89.8249 19.2678 89.8249 15.6703C89.8135 12.3792 87.9343 10.5862 85.9413 10.5862ZM85.2579 18.4053C84.586 18.4053 84.1874 18.167 83.914 17.8719L83.9026 13.6616C84.1988 13.3325 84.6088 13.1055 85.2579 13.1055C86.2943 13.1055 87.0118 14.2631 87.0118 15.7497C87.0118 17.2704 86.3057 18.4053 85.2579 18.4053Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M77.1377 9.91656L79.9963 9.30374V7L77.1377 7.60147V9.91656Z" fill="white"></path><path d="M79.9963 10.7791H77.1377V20.709H79.9963V10.7791Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M74.074 11.6187L73.8918 10.7789H71.4318V20.7088H74.279V13.9792C74.9509 13.1054 76.0898 13.2642 76.4429 13.3891V10.7789C76.0784 10.6427 74.7459 10.3931 74.074 11.6187Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M68.3796 8.31641L65.6007 8.90653L65.5894 17.9966C65.5894 19.6762 66.8535 20.9132 68.5391 20.9132C69.473 20.9132 70.1563 20.743 70.5321 20.5387V18.235C70.1677 18.3825 68.3682 18.9045 68.3682 17.225V13.1962H70.5321V10.779H68.3682L68.3796 8.31641Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M60.6807 13.6616C60.6807 13.219 61.0452 13.0488 61.6488 13.0488C62.5143 13.0488 63.6076 13.3098 64.4732 13.7751V11.1082C63.5279 10.7337 62.594 10.5862 61.6488 10.5862C59.3368 10.5862 57.7993 11.7891 57.7993 13.7978C57.7993 16.93 62.1271 16.4306 62.1271 17.7811C62.1271 18.3031 61.6715 18.4734 61.0338 18.4734C60.0885 18.4734 58.8813 18.0875 57.9246 17.5655V20.2664C58.9838 20.7204 60.0543 20.9133 61.0338 20.9133C63.4026 20.9133 65.0313 19.7444 65.0313 17.713C65.0199 14.3312 60.6807 14.9326 60.6807 13.6616Z" fill="white"></path></svg><a href="/docs/adopting">Get started</a> · <a href="/docs/overview">Docs</a> · <a href="https://sorbet.run">Try</a> · <a href="/en/community">Community</a> · <a href="/blog">Blog</a> · <a href="https://twitter.com/sorbet_ruby">Twitter</a></p></div><div id="csat-extension-config" data-notify="#sorbet-team"></div></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                appId: 'ZYWC6Z01G8',
                apiKey: 'b05a65e9f8d9f50dc4ec3241db8836c4',
                indexName: 'stripe_sorbet',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>