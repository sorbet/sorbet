<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>RBS Comments Support · Sorbet</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Signature comments"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="RBS Comments Support · Sorbet"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sorbet.org/"/><meta property="og:description" content="## Signature comments"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://sorbet.org/blog/atom.xml" title="Sorbet Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://sorbet.org/blog/feed.xml" title="Sorbet Blog RSS Feed"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5H7PQ9Z8KF"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments); }
              gtag('js', new Date());
              gtag('config', 'G-5H7PQ9Z8KF');
            </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/sorbet-logo-white-sparkles.svg" alt="Sorbet"/><h2 class="headerTitleWithLogo">Sorbet</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/adopting" target="_self">Get started</a></li><li class="siteNavGroupActive"><a href="/docs/overview" target="_self">Docs</a></li><li class=""><a href="https://sorbet.run" target="_self">Try</a></li><li class=""><a href="/en/community" target="_self">Community</a></li><li class=""><a href="https://github.com/sorbet/sorbet" target="_self">GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Experimental Features</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/adopting">Adopting Sorbet</a></li><li class="navListItem"><a class="navItem" href="/docs/metrics">Tracking Adoption</a></li><li class="navListItem"><a class="navItem" href="/docs/quickref">Quick Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/vscode">Visual Studio Code</a></li><li class="navListItem"><a class="navItem" href="/docs/from-typescript">TypeScript ↔ Sorbet</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Static &amp; Runtime</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/gradual">Gradual Type Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/static">Enabling Static Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime">Enabling Runtime Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/rbi">RBI Files</a></li><li class="navListItem"><a class="navItem" href="/docs/cli">CLI Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/cli-ref">CLI Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/tconfiguration">Runtime Configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/troubleshooting">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/why-type-annotations">Why type annotations?</a></li><li class="navListItem"><a class="navItem" href="/docs/faq">FAQ</a></li><li class="navListItem"><a class="navItem" href="/docs/error-reference">Error Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/unsupported">Unsupported Ruby Features</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Type System</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/sigs">sig</a></li><li class="navListItem"><a class="navItem" href="/docs/type-annotations">Type Annotations (non-sig)</a></li><li class="navListItem"><a class="navItem" href="/docs/type-assertions">T.let, T.cast, T.must, T.bind</a></li><li class="navListItem"><a class="navItem" href="/docs/class-types">Class Types (Integer, String)</a></li><li class="navListItem"><a class="navItem" href="/docs/stdlib-generics">Arrays &amp; Hashes</a></li><li class="navListItem"><a class="navItem" href="/docs/nilable-types">Nilable Types (T.nilable)</a></li><li class="navListItem"><a class="navItem" href="/docs/union-types">Union Types (T.any)</a></li><li class="navListItem"><a class="navItem" href="/docs/flow-sensitive">Flow-Sensitivity (is_a?, nil?)</a></li><li class="navListItem"><a class="navItem" href="/docs/type-aliases">T.type_alias</a></li><li class="navListItem"><a class="navItem" href="/docs/exhaustiveness">Exhaustiveness (T.absurd)</a></li><li class="navListItem"><a class="navItem" href="/docs/tstruct">T::Struct</a></li><li class="navListItem"><a class="navItem" href="/docs/tenum">T::Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/untyped">T.untyped</a></li><li class="navListItem"><a class="navItem" href="/docs/procs">Blocks, Procs, &amp; Lambdas</a></li><li class="navListItem"><a class="navItem" href="/docs/abstract">Abstract Classes &amp; Interfaces</a></li><li class="navListItem"><a class="navItem" href="/docs/final">Final Methods &amp; Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/override-checking">Override Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/sealed">Sealed Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/class-of">T.class_of</a></li><li class="navListItem"><a class="navItem" href="/docs/self-type">T.self_type</a></li><li class="navListItem"><a class="navItem" href="/docs/noreturn">T.noreturn</a></li><li class="navListItem"><a class="navItem" href="/docs/anything">T.anything</a></li><li class="navListItem"><a class="navItem" href="/docs/attached-class">T.attached_class</a></li><li class="navListItem"><a class="navItem" href="/docs/intersection-types">Intersection Types (T.all)</a></li><li class="navListItem"><a class="navItem" href="/docs/generics">Generics</a></li><li class="navListItem"><a class="navItem" href="/docs/non-forcing-constants">T::NonForcingConstants</a></li><li class="navListItem"><a class="navItem" href="/docs/strong">Banning untyped</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Editor Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/lsp">Language Server (LSP)</a></li><li class="navListItem"><a class="navItem" href="/docs/server-status">Server Status</a></li><li class="navListItem"><a class="navItem" href="/docs/lsp-typed-level">LSP &amp; Typed Level</a></li><li class="navListItem"><a class="navItem" href="/docs/go-to-def">Go to Definition</a></li><li class="navListItem"><a class="navItem" href="/docs/hover">Hover</a></li><li class="navListItem"><a class="navItem" href="/docs/autocompletion">Autocompletion</a></li><li class="navListItem"><a class="navItem" href="/docs/references">Find All References</a></li><li class="navListItem"><a class="navItem" href="/docs/code-actions">Code Actions</a></li><li class="navListItem"><a class="navItem" href="/docs/outline">Outline &amp; Document Symbols</a></li><li class="navListItem"><a class="navItem" href="/docs/doc-comments">Documentation Comments</a></li><li class="navListItem"><a class="navItem" href="/docs/sig-suggestion">Suggesting sigs</a></li><li class="navListItem"><a class="navItem" href="/docs/highlight-untyped">Highlighting untyped</a></li><li class="navListItem"><a class="navItem" href="/docs/sorbet-uris">sorbet: URIs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Experimental Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/tuples">Tuples</a></li><li class="navListItem"><a class="navItem" href="/docs/shapes">Shapes</a></li><li class="navListItem"><a class="navItem" href="/docs/overloads">Overloads</a></li><li class="navListItem"><a class="navItem" href="/docs/requires-ancestor">Requiring Ancestors</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/rbs-support">RBS Comments</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/sorbet/sorbet/edit/master/website/docs/rbs-support.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">RBS Comments Support</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="signature-comments"></a><a href="#signature-comments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Signature comments</h2>
<blockquote>
<p>This feature is experimental and might be changed or removed without notice. To enable it pass the <code>--enable-experimental-rbs-comments</code> option to Sorbet or add it to your <code>sorbet/config</code>.</p>
</blockquote>
<p>Sorbet has experimental support for comment-only type syntax, powered by <a href="https://github.com/ruby/rbs">RBS</a> annotations.</p>
<p>The syntax looks like this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: (Integer) -&gt; String</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x)</span></span>
  T.reveal_type(x) <span class="hljs-comment"># Revealed type: `Integer`</span>

  x.to_s
<span class="hljs-keyword">end</span>

str = foo(<span class="hljs-number">42</span>)
T.reveal_type(str) <span class="hljs-comment"># Revealed type: `String`</span>
</code></pre>
<p>This feature is powered by translating RBS comments to equivalent <code>sig</code> syntax. For example, the previous example is similar to having written a <code>sig</code> directly:</p>
<pre><code class="hljs css language-ruby">sig { params(<span class="hljs-symbol">x:</span> Integer).returns(String) }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x)</span></span>
  ...
<span class="hljs-keyword">end</span>
</code></pre>
<p>Long signatures can be broken into multiple lines using the <code>#|</code> continuation comment:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: (</span>
<span class="hljs-comment">#|  Integer,</span>
<span class="hljs-comment">#|  String</span>
<span class="hljs-comment">#| ) -&gt; Float</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x, y)</span></span>; <span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="caveats"></a><a href="#caveats" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Caveats</h2>
<blockquote>
<p>Support for this feature is experimental, and we actively discourage depending on it for anything other than to offer feedback to the Sorbet developers.</p>
</blockquote>
<p>There are numerous shortcomings of the comment-based syntax versus <code>sig</code> syntax. By contrast, the near-sole upside is that the syntax is terser.</p>
<h3><a class="anchor" aria-hidden="true" id="the-comment-based-syntax-is-second-class"></a><a href="#the-comment-based-syntax-is-second-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The comment-based syntax is second class</h3>
<p>The comment-based syntax uses <a href="https://github.com/ruby/rbs">RBS syntax</a>. RBS is an alternative annotation syntax for Ruby. The headline features of RBS:</p>
<ul>
<li>It’s the type annotation syntax blessed by the Ruby core team, and Matz in particular (the lead of the Ruby project).</li>
<li>RBS supports certain enticing features, like duck typing.</li>
<li>The syntax is terse.</li>
<li>The Ruby distribution bundles a gem for parsing RBS annotations.</li>
</ul>
<p>However, there are a number of problems which mean that RBS syntax has a second-class position in Sorbet:</p>
<h3><a class="anchor" aria-hidden="true" id="rbs-syntax-does-not-match-the-semantics-of-sorbet"></a><a href="#rbs-syntax-does-not-match-the-semantics-of-sorbet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RBS syntax does not match the semantics of Sorbet</h3>
<p>Sorbet’s type annotation syntax evolved differently from the evolution of RBS syntax. Unfortunately, this difference is not syntax-deep: it affects the semantics of the types too.</p>
<p>Sure, there are similarities: both syntaxes offer a way to express union types, for example. But there are also semantic differences, and RBS syntax reflects these differences. Things which are possible to express in RBS syntax have no analogue in Sorbet and vice versa. Some examples:</p>
<ul>
<li>RBS supports duck typing via interfaces (different from Sorbet’s <a href="/docs/abstract">interfaces</a>), but <a href="/docs/faq#can-i-use-sorbet-for-duck-typed-code">Sorbet does not support duck typing</a>, by design.</li>
<li>With Sorbet all class singleton classes are generic (<a href="/docs/class-of#tclass_of-applying-type-arguments-to-a-singleton-class-type"><code>T.class_of(...)[...]</code></a>). RBS does not have syntax to represent this.</li>
<li>By extension, Sorbet allows singleton classes to declare their own generic type parameters (with <a href="/docs/generics#type_member--type_template">type_template</a>). This also cannot be translated from RBS for the same limitation with RBS’s singleton class type annotation.</li>
<li>RBS supports literal value types. Sorbet does not.</li>
</ul>
<p>Because of these differences, it’s reasonable to assume that a codebase wishing to take full advantage of Sorbet’s unique features will eventually need to have annotations that use <code>sig</code> syntax. The moment a method’s annotation needs to use Sorbet-only syntax, the entire annotation needs to get rewritten—it’s not possible to embed Sorbet-only syntax within the context of an RBS signature. While it is possible for RBS comment signatures to coexist with Sorbet <code>sig</code> signatures, needing to flip between them adds development friction.</p>
<h3><a class="anchor" aria-hidden="true" id="sorbet-has-minimal-influence-over-the-evolution-of-rbs-syntax"></a><a href="#sorbet-has-minimal-influence-over-the-evolution-of-rbs-syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sorbet has minimal influence over the evolution of RBS syntax</h3>
<p>Sorbet continues to evolve its type syntax. For example, <code>T.anything</code>, <code>T::Class</code>, and <code>has_attached_class!</code> are additions to Sorbet which arrived 6 years after Sorbet’s inception—Sorbet development is anything but stale!</p>
<p>Sorbet can adapt more quickly to the needs of Sorbet users by building on its own syntax. Historically, it has been difficult to advocate to adding RBS features that benefit Sorbet specifically.</p>
<p>Our belief is that syntax matters less than semantics; that “what’s possible to express in the type system” matters more than “how to express it.” Time spent bikeshedding syntax detracts from meaningful improvements to the type system.</p>
<h3><a class="anchor" aria-hidden="true" id="ide-integration-is-more-difficult"></a><a href="#ide-integration-is-more-difficult" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IDE integration is more difficult</h3>
<p>Sorbet’s type syntax doubles as Ruby syntax. Setting aside other benefits of reusing Ruby syntax for type annotations (e.g., <a href="/docs/runtime">runtime checking</a>, no need to transpile, seamless integration with linters, etc.), Sorbet’s syntax integrates easily with existing editors.</p>
<p>There are a lot of features that come for free by reusing Ruby syntax:</p>
<ul>
<li><p>Syntax highlighting</p>
<p>Highlighting for RBS comment-based type annotations is provided through the <a href="https://github.com/Shopify/ruby-lsp">Ruby LSP</a>. Without it, they will be monochromatic, highlighted like comments.</p></li>
<li><p>Syntax error tolerance and recovery</p>
<p>The RBS comment parser does not recover from syntax errors. If there’s a syntax error in an RBS comment, Sorbet will ignore the entire <code>sig</code> until the error is fixed.</p></li>
<li><p>Autocompletion</p>
<p>Without error tolerance, autocompletion support is unreliable.</p></li>
</ul>
<p>In fairness, these are technical, implementation considerations, and thus could hope to improve one day. But they remain problems today.</p>
<h3><a class="anchor" aria-hidden="true" id="performance-is-worse"></a><a href="#performance-is-worse" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Performance is worse</h3>
<p>The chosen implementation for RBS annotations in comments is:</p>
<ol>
<li>Scan and parse the file, like normal.</li>
<li>Using the parsed file contents, re-scan the file, looking for comments, because Sorbet does not feed parsed comments throughout its pipeline.</li>
<li>Parse the RBS comments, using a third-party RBS parser, which manages memory allocations using it’s own internal data structures.</li>
<li>Translate the parsed RBS types to equivalent Ruby ASTs, and splice those ASTs into the parse result.</li>
<li>Allow Sorbet to continue, where signatures and type annotations will be analyzed later in the pipeline.</li>
</ol>
<pre><code class="hljs">┌──────────────┐
│  <span class="hljs-built_in">scan</span>+<span class="hljs-built_in">parse</span>  │
└──────┬───────┘
       ├──────────────────────────┐
       │                          ▼
       │                   ┌──────────────┐
       │                   │  <span class="hljs-built_in">scan</span> again  │
       │                   └──────┬───────┘
       │                          ▼
       │                   ┌─────────────┐
       │                   │  <span class="hljs-built_in">parse</span> RBS  │
       │                   └──────┬──────┘
       │                          ▼
       │                   ┌─────────────┐
       │                   │  translate  │
       │                   └─────────────┘
       ├──────────────────────────┘
       ▼
┌────────────────┐
│  ingest types  │
└────────────────┘
</code></pre>
<p>This implementation is simple, making it easy to verify correctness. The RBS parser can be developed as a library and tested independently. As long as the translation produces Sorbet ASTs equivalent to <code>sig</code> annotations that a user would have written, ingesting the types will work correctly.</p>
<p>But steps 2 and 4 are pure overhead (step 3 is a wash). Not only does this implementation scan every file which <em>might</em> use RBS comments twice, but it does not parse straight into Sorbet’s internal type representation.</p>
<p>In large codebases, this adds nontrivial overhead, and is a blocker in the way of being able to advocate for using this syntax more widely.</p>
<h4><a class="anchor" aria-hidden="true" id="runtime-checking-is-a-feature"></a><a href="#runtime-checking-is-a-feature" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Runtime checking is a feature</h4>
<blockquote>
<p>Note that runtime checking of RBS signatures is not implemented, so type safety is reduced.</p>
</blockquote>
<p>Sorbet’s signatures are not just static type annotations: they are also <a href="/docs/runtime">checked at runtime</a>. Runtime-checked signatures are a key reason why Sorbet type annotations are so accurate: authors can’t “lie” when writing type annotations.</p>
<p>For more information on why runtime checking is valuable, see here:</p>
<p>→ <a href="https://blog.jez.io/runtime-type-checking/">Runtime type checking is great</a></p>
<p>In fact, runtime checking for signatures is actually load bearing: simply disabling runtime checking can make the code change behavior when run.</p>
<h4><a class="anchor" aria-hidden="true" id="the-sorbet-docs-will-continue-using-sorbet-syntax"></a><a href="#the-sorbet-docs-will-continue-using-sorbet-syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Sorbet docs will continue using Sorbet syntax</h4>
<p>There are no plans to rewrite the Sorbet website to present RBS alternatives alongside the existing Sorbet syntax. In the mean time, users will need to mentally translate from Sorbet syntax to RBS syntax on their own, including understanding the cases where there is no suitable RBS replacement.</p>
<h2><a class="anchor" aria-hidden="true" id="quick-reference"></a><a href="#quick-reference" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Quick reference</h2>
<p>Most RBS features can be used and will be translated to equivalent Sorbet syntax during type checking:</p>
<table>
<thead><tr><th>RBS Feature</th><th>RBS syntax</th><th>Sorbet syntax</th></tr></thead>
<tbody>
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#class-instance-type">Class instance type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">Foo
</code></pre>
</td><td><a href="class-types">
<pre><code class="hljs css language-ruby">Foo
</code></pre>
<p></a></td></tr></p>
<!-- end of Class instance type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#class-singleton-type">Class singleton type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">singleton(Foo)
</code></pre>
</td><td><a href="class-of">
<pre><code class="hljs css language-ruby">T.class_of(Foo)
</code></pre>
<p></a></td></tr></p>
<!-- end of Class singleton type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#union-type">Union type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">Foo | Bar
</code></pre>
</td><td><a href="union-types">
<pre><code class="hljs css language-ruby">T.any(Foo, Bar)
</code></pre>
<p></a></td></tr></p>
<!-- end of Union type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#intersection-type">Intersection type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">Foo &amp; Bar
</code></pre>
</td><td><a href="intersection-types">
<pre><code class="hljs css language-ruby">T.all(Foo, Bar)
</code></pre>
<p></a></td></tr></p>
<!-- end of Intersection type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#optional-type">Optional type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">Foo?
</code></pre>
</td><td><a href="nilable-types">
<pre><code class="hljs css language-ruby">T.nilable(Foo)
</code></pre>
<p></a></td></tr></p>
<!-- end of Optional type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#base-types">Untyped type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">untyped
</code></pre>
</td><td><a href="untyped">
<pre><code class="hljs css language-ruby">T.untyped
</code></pre>
<p></a></td></tr></p>
<!-- end of Untyped type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#bool-or-boolish">Boolean type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">bool
</code></pre>
</td><td><a href="class-types#booleans">
<pre><code class="hljs css language-ruby">T::Boolean
</code></pre>
<p></a></td></tr></p>
<!-- end of Boolean type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#nil-or-nilclass">Nil type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">nil
</code></pre>
</td><td><a href="class-types#nil">
<pre><code class="hljs css language-ruby">NilClass
</code></pre>
<p></a></td></tr></p>
<!-- end of Nil type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#base-types">Top type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">top
</code></pre>
</td><td><a href="anything">
<pre><code class="hljs css language-ruby">T.anything
</code></pre>
<p></a></td></tr></p>
<!-- end of Top type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#base-types">Bottom type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">bot
</code></pre>
</td><td><a href="noreturn">
<pre><code class="hljs css language-ruby">T.noreturn
</code></pre>
<p></a></td></tr></p>
<!-- end of Bottom type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#base-types">Void type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">void
</code></pre>
</td><td><a href="sigs#returns--void-annotating-return-types">
<pre><code class="hljs css language-ruby">void
</code></pre>
<p></a></td></tr></p>
<!-- end of Void type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#type-variable">Generic type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">Foo[Bar]
</code></pre>
</td><td><a href="generics">
<pre><code class="hljs css language-ruby">Foo[Bar]
</code></pre>
<p></a></td></tr></p>
<!-- end of Generic type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#type-variable">Generic method</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">[U] (U foo) -&gt; U
</code></pre>
</td><td><a href="generics#generic-methods">
<pre><code class="hljs css language-ruby">type_parameters(<span class="hljs-symbol">:U</span>)
  .params(<span class="hljs-symbol">foo:</span> T.type_parameter(<span class="hljs-symbol">:U</span>))
  .returns(T.type_parameter(<span class="hljs-symbol">:U</span>))
</code></pre>
<p></a></td></tr></p>
<!-- end of Generic method -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#tuple-type">Tuple type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">[Foo, Bar]
</code></pre>
</td><td><a href="tuples">
<pre><code class="hljs css language-ruby">[Foo, Bar]
</code></pre>
<p></a></td></tr></p>
<!-- end of Tuple type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#record-type">Shape type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">{ a: Foo, b: Bar }
</code></pre>
</td><td><a href="shapes">
<pre><code class="hljs css language-ruby">{ <span class="hljs-symbol">a:</span> Foo, <span class="hljs-symbol">b:</span> Bar }
</code></pre>
<p></a></td></tr></p>
<!-- end of Shape type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#proc-type">Proc type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">^(Foo) -&gt; Bar
</code></pre>
</td><td><a href="procs">
<pre><code class="hljs css language-ruby">T.proc.params(<span class="hljs-symbol">arg:</span> Foo).returns(Bar)
</code></pre>
<p></a></td></tr></p>
<!-- end of Proc type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#method-types-and-proc-types">Block type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">{ (Foo) -&gt; Bar }
</code></pre>
</td><td><a href="procs">
<pre><code class="hljs css language-ruby">T.proc.params(<span class="hljs-symbol">arg:</span> Foo).returns(Bar)
</code></pre>
<p></a></td></tr></p>
<!-- end of Block type -->
<tr><td>
<p><a href="https://github.com/ruby/rbs/blob/master/docs/syntax.md#method-types-and-proc-types">Optional Block type</a></p>
</td><td>
<pre><code class="hljs css language-plaintext">?{ (Foo) -&gt; Bar }
</code></pre>
</td><td><a href="procs#optional-blocks">
<pre><code class="hljs css language-ruby">T.nilable(T.proc.params(<span class="hljs-symbol">arg:</span> Foo).returns(Bar))
</code></pre>
<p></a></td></tr></p>
<!-- end of Optional Block type -->
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="attribute-accessor-types"></a><a href="#attribute-accessor-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attribute accessor types</h2>
<p>Attribute accessors can be annotated with RBS types:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: String</span>
<span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:foo</span>

<span class="hljs-comment">#: Integer</span>
<span class="hljs-keyword">attr_writer</span> <span class="hljs-symbol">:bar</span>

<span class="hljs-comment">#: String</span>
<span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:baz</span>
</code></pre>
<p>Long attribute types can span over multiple lines:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [</span>
<span class="hljs-comment">#|   Integer,</span>
<span class="hljs-comment">#|   String</span>
<span class="hljs-comment">#| ]</span>
<span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:foo</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="abstract-methods"></a><a href="#abstract-methods" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Abstract methods</h2>
<p>Methods can be marked as abstract with using the <code>@abstract</code> annotation comment:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># <span class="hljs-doctag">@abstract</span></span>
<span class="hljs-comment">#: -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baz</span></span>
  raise <span class="hljs-string">"not implemented"</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Note that contrary to Sorbet’s <code>abstract</code> methods, methods annotated with <code>@abstract</code> must always raise an error.</p>
<h2><a class="anchor" aria-hidden="true" id="method-annotations"></a><a href="#method-annotations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Method annotations</h2>
<p>While RBS does not support the same modifiers as Sorbet, it is possible to specify them using <code>@</code> annotation comments.</p>
<p>The following signatures are equivalent:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># <span class="hljs-doctag">@override</span></span>
<span class="hljs-comment">#: (Integer) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bar1</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

sig { override.params(<span class="hljs-symbol">x:</span> Integer).void }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bar2</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

<span class="hljs-comment"># <span class="hljs-doctag">@override</span>(allow_incompatible: true)</span>
<span class="hljs-comment">#: (Integer) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baz1</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

sig { override(<span class="hljs-symbol">allow_incompatible:</span> <span class="hljs-literal">true</span>).params(<span class="hljs-symbol">x:</span> Integer).void }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baz2</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

<span class="hljs-comment"># <span class="hljs-doctag">@final</span></span>
<span class="hljs-comment">#: (Integer) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">qux1</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

sig(<span class="hljs-symbol">:final</span>) { params(<span class="hljs-symbol">x:</span> Integer).void }
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">qux2</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>
</code></pre>
<p>Note: these annotations like <code>@override</code> use normal comments, like <code># @override</code> (not the special <code>#:</code> comment). This makes it possible to reuse any existing YARD or RDoc annotations.</p>
<h2><a class="anchor" aria-hidden="true" id="class-and-module-annotations"></a><a href="#class-and-module-annotations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Class and module annotations</h2>
<p>RBS annotations can be used to add Sorbet helpers to classes like <a href="/docs/abstract"><code>abstract!</code></a>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># <span class="hljs-doctag">@abstract</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span>
  extend T::Helpers

  abstract!
<span class="hljs-keyword">end</span>
</code></pre>
<p>The <a href="/docs/abstract"><code>@interface!</code></a>, <a href="/docs/final"><code>@final!</code></a>, and <a href="/docs/sealed"><code>@sealed!</code></a> annotations are supported in the same way.</p>
<p>The <a href="/docs/requires-ancestor"><code>@requires_ancestor</code></a> annotation expects an argument to represent the ancestor to require:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># <span class="hljs-doctag">@requires</span>_ancestor: ::Some::Ancestor</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span>;</span> <span class="hljs-keyword">end</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span>
  extend T::Helpers

  requires_ancestor { Some::Ancestor }
<span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="generic-classes-and-modules"></a><a href="#generic-classes-and-modules" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generic classes and modules</h2>
<p>RBS supports generic classes and modules.</p>
<h3><a class="anchor" aria-hidden="true" id="type-members"></a><a href="#type-members" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Type members</h3>
<p><a href="generics#type_member--type_template">Type members</a> can be specified using a <code>#:</code> comment on the class or module:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span></span>
  <span class="hljs-comment">#: -&gt; void</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
    @elems = [] <span class="hljs-comment">#: T::Array[E]</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment">#: (E) -&gt; void</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">&lt;&lt;</span><span class="hljs-params">(e)</span></span>
    @elems &lt;&lt; e
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

box = Box.new <span class="hljs-comment">#: Box[Integer]</span>
box &lt;&lt; <span class="hljs-number">42</span>
</code></pre>
<p>RBS generics do not use <code>T::Generic</code>, thus the <code>[]</code> method doesn’t exist at runtime and Sorbet will report an error if you try to use it:</p>
<pre><code class="hljs css language-ruby">Box[Integer].new
   ^^^^^^^^^ <span class="hljs-symbol">error:</span> Method <span class="hljs-string">`[]`</span> does <span class="hljs-keyword">not</span> exist on <span class="hljs-string">`T.class_of(Box)`</span>
</code></pre>
<p>Because of this, Sorbet will use the RBS comment type as the type of the class being instantiated:</p>
<pre><code class="hljs css language-ruby">box = Box.new <span class="hljs-comment">#: Box[Integer]</span>
T.reveal_type(box) <span class="hljs-comment"># Revealed type: `Box[Integer]`</span>
</code></pre>
<p>To change the type of the class being instantiated, the expression can be broken into multiple lines:</p>
<pre><code class="hljs css language-ruby">nilable_box = Box <span class="hljs-comment">#: Class[Box[Integer]]</span>
   .new <span class="hljs-comment">#: Box[Integer]?</span>
T.reveal_type(nilable_box) <span class="hljs-comment"># =&gt; `T.nilable(Box[Integer])`</span>

<span class="hljs-number">1</span>.times <span class="hljs-keyword">do</span>
  nilable_box = <span class="hljs-literal">nil</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>You can also use an intermediate variable to change the type of the class being instantiated:</p>
<pre><code class="hljs css language-ruby">box_of_integer = Box.new(<span class="hljs-string">"foo"</span>) <span class="hljs-comment">#: Box[Integer]</span>
T.reveal_type(box_of_integer) <span class="hljs-comment"># =&gt; `Box[Integer]`</span>
nilable_box = box_of_integer <span class="hljs-comment">#: as Box[Integer]?</span>
T.reveal_type(nilable_box) <span class="hljs-comment"># =&gt; `T.nilable(Box[Integer])`</span>

<span class="hljs-number">1</span>.times <span class="hljs-keyword">do</span>
  nilable_box = <span class="hljs-literal">nil</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="type-templates"></a><a href="#type-templates" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Type templates</h3>
<p>There is no equivalent to <code>type_template</code> in RBS. Instead, you can define type members on the singleton class. So this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Factory</span></span>
  extend T::Sig
  extend T::Generic

  InstanceType = type_template

  sig { returns(InstanceType) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">self</span>.<span class="hljs-title">make</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Can be written as:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Factory</span></span>
  <span class="hljs-comment">#: [InstanceType]</span>
  <span class="hljs-class"><span class="hljs-keyword">class</span> &lt;&lt; self</span>
    <span class="hljs-comment">#: -&gt; InstanceType</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make</span>;</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Note: there is no RBS equivalent to the generic <code>T.class_of()[]</code> syntax just yet.</p>
<h3><a class="anchor" aria-hidden="true" id="variance"></a><a href="#variance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Variance</h3>
<p><a href="/docs/generics#in-out-and-variance">Variance</a> can be specified using the <code>in</code> and <code>out</code> keywords:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [out E]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span></span>
<span class="hljs-keyword">end</span>

box = Box.new <span class="hljs-comment">#: Box[Integer]</span>
box <span class="hljs-comment">#: Box[Numeric]</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="bounds"></a><a href="#bounds" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bounds</h3>
<p>By default, type parameters do not have <a href="/docs/generics#bounds-on-type_members-and-type_templates-fixed-upper-lower">bounds</a>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>;</span> <span class="hljs-keyword">end</span>

box = Box.new <span class="hljs-comment">#: Box[Integer]</span>
</code></pre>
<p>Upper bounds can be specified using <code>&lt;</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E &lt; Numeric]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>;</span> <span class="hljs-keyword">end</span>

Box.new <span class="hljs-comment">#: Box[Integer]</span>
Box.new <span class="hljs-comment">#: Box[String]</span>
               ^^^^^^ <span class="hljs-symbol">error:</span> <span class="hljs-string">`String`</span> is <span class="hljs-keyword">not</span> a subtype of upper bound of type member <span class="hljs-string">`::Box::E`</span>
</code></pre>
<p>Lower bounds can be specified using <code>&gt;</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E &gt; Numeric]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>;</span> <span class="hljs-keyword">end</span>

Box.new <span class="hljs-comment">#: Box[Object]</span>
Box.new <span class="hljs-comment">#: Box[Integer]</span>
               ^^^^^^^ <span class="hljs-symbol">error:</span> <span class="hljs-string">`Integer`</span> is <span class="hljs-keyword">not</span> a supertype of lower bound of type member <span class="hljs-string">`::Box::E`</span>
</code></pre>
<p>Fixed bounds can be specified using <code>=</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E = Integer]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>;</span> <span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="type-aliases"></a><a href="#type-aliases" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Type aliases</h2>
<p>Type aliases can be declared using a standalone comment:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: type int_or_string = Integer | String</span>

<span class="hljs-comment">#: (int_or_string) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

foo(<span class="hljs-number">1</span>) <span class="hljs-comment"># no error</span>
foo(<span class="hljs-string">"foo"</span>) <span class="hljs-comment"># no error</span>
foo(<span class="hljs-literal">nil</span>) <span class="hljs-comment"># error: Expected `T.any(Integer, String)` but found `NilClass` for argument `x`</span>
</code></pre>
<p>Multiline syntax is also supported:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: type int_or_string =</span>
<span class="hljs-comment">#|   Integer |</span>
<span class="hljs-comment">#|   String</span>
</code></pre>
<p>RBS type aliases are scoped to the class or module where they are declared:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span>
  <span class="hljs-comment">#: type int_or_string =</span>
  <span class="hljs-comment">#|   Integer |</span>
  <span class="hljs-comment">#|   String</span>

  <span class="hljs-comment"># ok</span>
  <span class="hljs-comment">#: (int_or_string) -&gt; void</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>

  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bar</span></span>
    <span class="hljs-comment"># ok</span>
    <span class="hljs-comment">#: (int_or_string) -&gt; void</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bar</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>


<span class="hljs-comment">#: (int_or_string) -&gt; void</span>
<span class="hljs-comment">#   ^^^^^^^^^^^^^ error: Unable to resolve constant `type int_or_string`</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">baz</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="special-behaviors"></a><a href="#special-behaviors" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Special behaviors</h2>
<p>The <code>#:</code> comment must come <strong>immediately</strong> before the following method definition. If there is a blank line between the comment and method definition, the comment will be ignored.</p>
<p>Generic types like <code>Array</code> or <code>Hash</code> are translated to their <code>T::</code> Sorbet types equivalent:</p>
<ul>
<li><code>Array[Integer]</code> is translated to <code>T::Array[Integer]</code></li>
<li><code>Class[Integer]</code> is translated to <code>T::Class[Integer]</code></li>
<li><code>Enumerable[Integer]</code> is translated to <code>T::Enumerable[Integer]</code></li>
<li><code>Enumerator[Integer]</code> is translated to <code>T::Enumerator[Integer]</code></li>
<li><code>Enumerator::Lazy[Integer]</code> is translated to <code>T::Enumerator::Lazy[Integer]</code></li>
<li><code>Enumerator::Chain[Integer]</code> is translated to <code>T::Enumerator::Chain[Integer]</code></li>
<li><code>Hash[String, Integer]</code> is translated to <code>T::Hash[String, Integer]</code></li>
<li><code>Range[Integer]</code> is translated to <code>T::Range[Integer]</code></li>
<li><code>Set[Integer]</code> is translated to <code>T::Set[Integer]</code></li>
</ul>
<p>Note that non-generic types are not translated, so <code>Array</code> without a type argument stays <code>Array</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="class-types"></a><a href="#class-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Class types</h3>
<p>The <code>class</code> type in RBS is context sensitive (depends on the class where it is used) and Sorbet does not support this feature yet. Instead, use the equivalent Sorbet syntax:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span>
  sig { returns(T.attached_class) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">self</span>.<span class="hljs-title">foo</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="interface-types"></a><a href="#interface-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Interface types</h3>
<p>Interface types are not supported, use the equivalent Sorbet syntax instead:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">Foo</span></span>
  extend T::Helpers

  interface!
<span class="hljs-keyword">end</span>

<span class="hljs-comment">#: (Foo) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">takes_foo</span><span class="hljs-params">(x)</span></span>; <span class="hljs-keyword">end</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="literal-types"></a><a href="#literal-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Literal types</h3>
<p>Sorbet does not support RBS’s concept of &quot;literal types&quot;. The next best thing is to use the literal’s underlying type instead:</p>
<ul>
<li><code>1</code> is <code>Integer</code></li>
<li><code>&quot;foo&quot;</code> is <code>String</code></li>
<li><code>:foo</code> is <code>Symbol</code></li>
<li><code>true</code> is <code>TrueClass</code></li>
<li><code>false</code> is <code>FalseClass</code></li>
<li><code>nil</code> is <code>NilClass</code></li>
</ul>
<p>You can also consider using <a href="/docs/tenum"><code>T::Enum</code></a>.</p>
<h3><a class="anchor" aria-hidden="true" id="unchecked-generics"></a><a href="#unchecked-generics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unchecked generics</h3>
<p>RBS <code>unchecked</code> generics are not supported by Sorbet, use <code>untyped</code> instead:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: [E]</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Box</span>;</span> <span class="hljs-keyword">end</span>

box = Box.new <span class="hljs-comment">#: Box[untyped]</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="type-assertions-comments"></a><a href="#type-assertions-comments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Type assertions comments</h2>
<blockquote>
<p>This feature is experimental and might be changed or removed without notice. To enable it pass the <code>--enable-experimental-rbs-comments</code> option to Sorbet or add it to your <code>sorbet/config</code>.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="tlet-assertions"></a><a href="#tlet-assertions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.let</code> assertions</h3>
<p><a href="/docs/type-assertions#tlet"><code>T.let</code></a> assertions can be expressed using RBS comments:</p>
<pre><code class="hljs css language-ruby">x = <span class="hljs-number">42</span> <span class="hljs-comment">#: Integer</span>
@x = <span class="hljs-number">42</span> <span class="hljs-comment">#: Integer</span>
X = <span class="hljs-number">42</span> <span class="hljs-comment">#: Integer</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">x = T.let(<span class="hljs-number">42</span>, Integer)
@x = T.let(<span class="hljs-number">42</span>, Integer)
X = T.let(<span class="hljs-number">42</span>, Integer)
</code></pre>
<p>The comment must be placed at the end of the assignment. Either on the same line if the assignment is on a single line, or on the last line if the assignment spans multiple lines:</p>
<pre><code class="hljs css language-ruby">x = [
  <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>
] <span class="hljs-comment">#: Array[Integer]</span>
</code></pre>
<p>The only exception is for HEREDOCs, where the comment may be placed on the first line of the HEREDOC:</p>
<pre><code class="hljs css language-ruby">X = <span class="hljs-string">&lt;&lt;~MSG #: String
  foo
MSG</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="tcast-assertions"></a><a href="#tcast-assertions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.cast</code> assertions</h3>
<p><a href="/docs/type-assertions#tcast"><code>T.cast</code></a> assertions can be expressed using RBS comments with the <code>as</code> keyword:</p>
<pre><code class="hljs css language-ruby">x = <span class="hljs-number">42</span> <span class="hljs-comment">#: as Integer</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">x = T.cast(<span class="hljs-number">42</span>, Integer)
</code></pre>
<p>The comment is always applied to the outermost expression. For example, in this method call, the cast is applied to the value returned by <code>foo</code> and not the argument <code>x</code>:</p>
<pre><code class="hljs css language-ruby">foo x <span class="hljs-comment">#: as Integer</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">T.cast(foo x, Integer)
</code></pre>
<p>It is possible to cast the argument <code>x</code> by using parentheses:</p>
<pre><code class="hljs css language-ruby">foo(
  x <span class="hljs-comment">#: as Integer</span>
)
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">foo(T.cast(x, Integer))
</code></pre>
<p>Casts comments can be used in any context where a type assertion is valid:</p>
<pre><code class="hljs css language-ruby">foo
  .bar <span class="hljs-comment">#: as Integer</span>
  .baz

[
  foo, <span class="hljs-comment">#: as Integer</span>
  {
    <span class="hljs-symbol">bar:</span> baz, <span class="hljs-comment">#: as String</span>
  }
]

x = <span class="hljs-keyword">if</span> foo
  bar
<span class="hljs-keyword">else</span>
  baz
<span class="hljs-keyword">end</span> <span class="hljs-comment">#: as Integer</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="tmust-assertions"></a><a href="#tmust-assertions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.must</code> assertions</h3>
<p><a href="/docs/type-assertions#tmust"><code>T.must</code></a> are denoted with the special <code>as !nil</code> comment:</p>
<pre><code class="hljs css language-ruby">foo <span class="hljs-comment">#: as !nil</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">T.must(foo)
</code></pre>
<p>The <code>as !nil</code> comment can be used in any context where a cast is valid and follows the same rules as <code>as Type</code> comments:</p>
<pre><code class="hljs css language-ruby">foo(
  x <span class="hljs-comment">#: as !nil</span>
)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="tunsafe-escape-hatch"></a><a href="#tunsafe-escape-hatch" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.unsafe</code> escape hatch</h3>
<p><a href="/docs/static#call-site-granularity-tunsafe"><code>T.unsafe</code></a> can be replaced with the special <code>as untyped</code> annotation:</p>
<pre><code class="hljs css language-ruby">x = <span class="hljs-number">42</span> <span class="hljs-comment">#: as untyped</span>
x.undefined_method <span class="hljs-comment"># no error statically, but will fail at runtime</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">x = T.unsafe(<span class="hljs-number">42</span>)
x.undefined_method
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="tabsurd"></a><a href="#tabsurd" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.absurd</code></h3>
<p><a href="/docs/exhaustiveness"><code>T.absurd</code></a> can be expressed using RBS comments:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment">#: (Integer | String) -&gt; void</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span><span class="hljs-params">(x)</span></span>
  <span class="hljs-keyword">case</span> x
  <span class="hljs-keyword">when</span> Integer
  <span class="hljs-keyword">when</span> String
  <span class="hljs-keyword">else</span>
    x <span class="hljs-comment">#: absurd</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby">T.absurd(x)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="tbind"></a><a href="#tbind" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>T.bind</code></h3>
<p><a href="/docs/type-assertions#tbind"><code>T.bind</code></a> can be expressed using RBS comments with the special <code>self as</code> construct:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Foo</span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">foo</span>;</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bar</span></span>
  <span class="hljs-comment">#: self as Foo</span>

  foo
<span class="hljs-keyword">end</span>
</code></pre>
<p>This is equivalent to:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">bar</span></span>
  T.bind(<span class="hljs-keyword">self</span>, Foo)

  foo
<span class="hljs-keyword">end</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/requires-ancestor"><span class="arrow-prev">← </span><span>Requiring Ancestors</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#signature-comments">Signature comments</a></li><li><a href="#caveats">Caveats</a><ul class="toc-headings"><li><a href="#the-comment-based-syntax-is-second-class">The comment-based syntax is second class</a></li><li><a href="#rbs-syntax-does-not-match-the-semantics-of-sorbet">RBS syntax does not match the semantics of Sorbet</a></li><li><a href="#sorbet-has-minimal-influence-over-the-evolution-of-rbs-syntax">Sorbet has minimal influence over the evolution of RBS syntax</a></li><li><a href="#ide-integration-is-more-difficult">IDE integration is more difficult</a></li><li><a href="#performance-is-worse">Performance is worse</a></li></ul></li><li><a href="#quick-reference">Quick reference</a></li><li><a href="#attribute-accessor-types">Attribute accessor types</a></li><li><a href="#abstract-methods">Abstract methods</a></li><li><a href="#method-annotations">Method annotations</a></li><li><a href="#class-and-module-annotations">Class and module annotations</a></li><li><a href="#generic-classes-and-modules">Generic classes and modules</a><ul class="toc-headings"><li><a href="#type-members">Type members</a></li><li><a href="#type-templates">Type templates</a></li><li><a href="#variance">Variance</a></li><li><a href="#bounds">Bounds</a></li></ul></li><li><a href="#type-aliases">Type aliases</a></li><li><a href="#special-behaviors">Special behaviors</a><ul class="toc-headings"><li><a href="#class-types">Class types</a></li><li><a href="#interface-types">Interface types</a></li><li><a href="#literal-types">Literal types</a></li><li><a href="#unchecked-generics">Unchecked generics</a></li></ul></li><li><a href="#type-assertions-comments">Type assertions comments</a><ul class="toc-headings"><li><a href="#tlet-assertions"><code>T.let</code> assertions</a></li><li><a href="#tcast-assertions"><code>T.cast</code> assertions</a></li><li><a href="#tmust-assertions"><code>T.must</code> assertions</a></li><li><a href="#tunsafe-escape-hatch"><code>T.unsafe</code> escape hatch</a></li><li><a href="#tabsurd"><code>T.absurd</code></a></li><li><a href="#tbind"><code>T.bind</code></a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><div class="wrapper"><p class="footer"><svg width="99" height="28" viewBox="0 0 99 28" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.98432 20H6.27432C8.44932 20 9.81432 18.905 9.81432 17.03C9.81432 15.665 9.00432 14.72 7.78932 14.39C8.61432 14.105 9.45432 13.415 9.45432 12.035C9.45432 10.235 8.23932 9.23 5.95932 9.23H1.98432V20ZM3.37932 13.85V10.445H5.83932C7.27932 10.445 8.07432 11 8.07432 12.155C8.07432 13.295 7.27932 13.85 5.83932 13.85H3.37932ZM3.37932 15.08H6.21432C7.65432 15.08 8.43432 15.83 8.43432 16.925C8.43432 18.035 7.65432 18.785 6.21432 18.785H3.37932V15.08ZM18.0294 12.155H16.6794V16.88C16.6794 18.185 15.6894 18.92 14.7144 18.92C13.5594 18.92 13.0794 18.17 13.0794 17.06V12.155H11.7294V17.345C11.7294 19.01 12.6744 20.165 14.3544 20.165C15.4644 20.165 16.2294 19.58 16.6794 18.92V20H18.0294V12.155ZM20.5112 10.79H21.9812V9.23H20.5112V10.79ZM21.9212 12.155H20.5712V20H21.9212V12.155ZM25.8247 9.23H24.4747V20H25.8247V9.23ZM28.5882 18.125C28.5882 19.625 29.3532 20.075 30.6882 20.075C31.1382 20.075 31.5282 20.03 31.8732 19.955V18.8C31.5582 18.875 31.3332 18.89 31.0182 18.89C30.3282 18.89 29.9232 18.74 29.9232 17.915V13.31H31.7082V12.155H29.9232V9.86H28.5882V12.155H27.3732V13.31H28.5882V18.125ZM41.0199 20.165C43.1949 20.165 44.4399 18.305 44.4399 16.085C44.4399 13.85 43.1949 12.005 41.0199 12.005C39.9249 12.005 39.0549 12.53 38.5899 13.295V9.23H37.2399V20H38.5899V18.86C39.0549 19.64 39.9249 20.165 41.0199 20.165ZM38.5599 15.815C38.5599 13.985 39.6699 13.19 40.7799 13.19C42.2499 13.19 43.0749 14.39 43.0749 16.085C43.0749 17.765 42.2499 18.98 40.7799 18.98C39.6699 18.98 38.5599 18.17 38.5599 16.37V15.815ZM49.1804 20.855L52.5554 12.155H51.1454L48.9704 18.155L46.7654 12.155H45.3404L48.2504 19.715L47.8754 20.645C47.5604 21.425 47.2454 21.635 46.6604 21.635C46.4354 21.635 46.2704 21.62 46.0154 21.56V22.73C46.2554 22.775 46.4204 22.79 46.7504 22.79C48.1154 22.79 48.7304 22.04 49.1804 20.855Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M98.7993 15.7838C98.7993 12.8786 97.3871 10.5862 94.688 10.5862C91.9774 10.5862 90.3374 12.8786 90.3374 15.7611C90.3374 19.177 92.2735 20.9019 95.0524 20.9019C96.4077 20.9019 97.4327 20.5955 98.2071 20.1643V17.8946C97.4327 18.2804 96.5443 18.5188 95.4168 18.5188C94.3121 18.5188 93.3327 18.1329 93.2074 16.7938H98.7766C98.7766 16.6463 98.7993 16.0561 98.7993 15.7838ZM93.1732 14.7057C93.1732 13.4233 93.9591 12.8899 94.6766 12.8899C95.3713 12.8899 96.1116 13.4233 96.1116 14.7057H93.1732Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M85.9413 10.5862C84.8251 10.5862 84.1076 11.1082 83.709 11.4714L83.561 10.7678H81.0554V24.0001L83.9026 23.3986L83.914 20.187C84.324 20.482 84.9276 20.9019 85.9299 20.9019C87.9685 20.9019 89.8249 19.2678 89.8249 15.6703C89.8135 12.3792 87.9343 10.5862 85.9413 10.5862ZM85.2579 18.4053C84.586 18.4053 84.1874 18.167 83.914 17.8719L83.9026 13.6616C84.1988 13.3325 84.6088 13.1055 85.2579 13.1055C86.2943 13.1055 87.0118 14.2631 87.0118 15.7497C87.0118 17.2704 86.3057 18.4053 85.2579 18.4053Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M77.1377 9.91656L79.9963 9.30374V7L77.1377 7.60147V9.91656Z" fill="white"></path><path d="M79.9963 10.7791H77.1377V20.709H79.9963V10.7791Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M74.074 11.6187L73.8918 10.7789H71.4318V20.7088H74.279V13.9792C74.9509 13.1054 76.0898 13.2642 76.4429 13.3891V10.7789C76.0784 10.6427 74.7459 10.3931 74.074 11.6187Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M68.3796 8.31641L65.6007 8.90653L65.5894 17.9966C65.5894 19.6762 66.8535 20.9132 68.5391 20.9132C69.473 20.9132 70.1563 20.743 70.5321 20.5387V18.235C70.1677 18.3825 68.3682 18.9045 68.3682 17.225V13.1962H70.5321V10.779H68.3682L68.3796 8.31641Z" fill="white"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M60.6807 13.6616C60.6807 13.219 61.0452 13.0488 61.6488 13.0488C62.5143 13.0488 63.6076 13.3098 64.4732 13.7751V11.1082C63.5279 10.7337 62.594 10.5862 61.6488 10.5862C59.3368 10.5862 57.7993 11.7891 57.7993 13.7978C57.7993 16.93 62.1271 16.4306 62.1271 17.7811C62.1271 18.3031 61.6715 18.4734 61.0338 18.4734C60.0885 18.4734 58.8813 18.0875 57.9246 17.5655V20.2664C58.9838 20.7204 60.0543 20.9133 61.0338 20.9133C63.4026 20.9133 65.0313 19.7444 65.0313 17.713C65.0199 14.3312 60.6807 14.9326 60.6807 13.6616Z" fill="white"></path></svg><a href="/docs/adopting">Get started</a> · <a href="/docs/overview">Docs</a> · <a href="https://sorbet.run">Try</a> · <a href="/en/community">Community</a> · <a href="/blog">Blog</a> · <a href="https://twitter.com/sorbet_ruby">Twitter</a></p></div><div id="csat-extension-config" data-notify="#sorbet-team"></div></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                appId: 'ZYWC6Z01G8',
                apiKey: 'b05a65e9f8d9f50dc4ec3241db8836c4',
                indexName: 'stripe_sorbet',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>