<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Frequently Asked Questions · Sorbet</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Why does Sorbet think this is `nil`? I just checked that it&#x27;s not!"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Frequently Asked Questions · Sorbet"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sorbet.org/"/><meta property="og:description" content="## Why does Sorbet think this is `nil`? I just checked that it&#x27;s not!"/><meta property="og:image" content="https://sorbet.org/img/sorbet-logo-card@2x.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://sorbet.org/img/sorbet-logo-card@2x.png"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://sorbet.org/blog/atom.xml" title="Sorbet Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://sorbet.org/blog/feed.xml" title="Sorbet Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-119877071-2', 'auto');
              ga('send', 'pageview');
            </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/sorbet-logo-white-sparkles.svg" alt="Sorbet"/><h2 class="headerTitleWithLogo">Sorbet</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/adopting" target="_self">Get started</a></li><li class="siteNavGroupActive"><a href="/docs/overview" target="_self">Docs</a></li><li class=""><a href="https://sorbet.run" target="_self">Try</a></li><li class=""><a href="/en/community" target="_self">Community</a></li><li class=""><a href="https://github.com/sorbet/sorbet" target="_self">GitHub</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Troubleshooting</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/adopting">Adopting Sorbet</a></li><li class="navListItem"><a class="navItem" href="/docs/metrics">Tracking Adoption</a></li><li class="navListItem"><a class="navItem" href="/docs/quickref">Quick Reference</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Static &amp; Runtime</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/gradual">Gradual Type Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/static">Enabling Static Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime">Enabling Runtime Checks</a></li><li class="navListItem"><a class="navItem" href="/docs/rbi">RBI Files</a></li><li class="navListItem"><a class="navItem" href="/docs/cli">Command Line Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/tconfiguration">Runtime Configuration</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Troubleshooting</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/troubleshooting">Troubleshooting</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/faq">FAQ</a></li><li class="navListItem"><a class="navItem" href="/docs/error-reference">Error Reference</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Type System</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/sigs">Signatures</a></li><li class="navListItem"><a class="navItem" href="/docs/type-annotations">Type Annotations</a></li><li class="navListItem"><a class="navItem" href="/docs/type-assertions">Type Assertions</a></li><li class="navListItem"><a class="navItem" href="/docs/class-types">Class Types</a></li><li class="navListItem"><a class="navItem" href="/docs/nilable-types">Nilable Types</a></li><li class="navListItem"><a class="navItem" href="/docs/union-types">Union Types</a></li><li class="navListItem"><a class="navItem" href="/docs/flow-sensitive">Flow Sensitivity</a></li><li class="navListItem"><a class="navItem" href="/docs/type-aliases">Type Aliases</a></li><li class="navListItem"><a class="navItem" href="/docs/exhaustiveness">Exhaustiveness Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/tstruct">T::Struct</a></li><li class="navListItem"><a class="navItem" href="/docs/tenum">T::Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/untyped">T.untyped</a></li><li class="navListItem"><a class="navItem" href="/docs/procs">Blocks, Procs, &amp; Lambdas</a></li><li class="navListItem"><a class="navItem" href="/docs/abstract">Abstract Classes &amp; Interfaces</a></li><li class="navListItem"><a class="navItem" href="/docs/final">Final Methods &amp; Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/override-checking">Override Checking</a></li><li class="navListItem"><a class="navItem" href="/docs/sealed">Sealed Classes</a></li><li class="navListItem"><a class="navItem" href="/docs/class-of">T.class_of</a></li><li class="navListItem"><a class="navItem" href="/docs/stdlib-generics">Arrays &amp; Hashes</a></li><li class="navListItem"><a class="navItem" href="/docs/self-type">T.self_type</a></li><li class="navListItem"><a class="navItem" href="/docs/noreturn">T.noreturn</a></li><li class="navListItem"><a class="navItem" href="/docs/attached-class">T.attached_class</a></li><li class="navListItem"><a class="navItem" href="/docs/intersection-types">Intersection Types</a></li><li class="navListItem"><a class="navItem" href="/docs/non-forcing-constants">T::NonForcingConstants</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Experimental Features</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/tuples">Tuples</a></li><li class="navListItem"><a class="navItem" href="/docs/shapes">Shapes</a></li><li class="navListItem"><a class="navItem" href="/docs/requires-ancestor">Requiring Ancestors</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/sorbet/sorbet/edit/master/website/docs/faq.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Frequently Asked Questions</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not"></a><a href="#why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why does Sorbet think this is <code>nil</code>? I just checked that it’s not!</h2>
<p>Sorbet implements a <a href="/docs/flow-sensitive">flow-sensitive</a> type system, but there
are some <a href="/docs/flow-sensitive#limitations-of-flow-sensitivity">limitations</a>. In
particular, Sorbet does not assume a method called twice returns the same thing
each time!</p>
<p>See
<a href="/docs/flow-sensitive#limitations-of-flow-sensitivity">Limitations of flow-sensitivity</a>
for a fully working example.</p>
<h2><a class="anchor" aria-hidden="true" id="it-looks-like-sorbets-types-for-the-stdlib-are-wrong"></a><a href="#it-looks-like-sorbets-types-for-the-stdlib-are-wrong" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>It looks like Sorbet’s types for the stdlib are wrong.</h2>
<p>Sorbet uses <a href="/docs/rbi">RBI files</a> to annotate the types for the Ruby standard
library. Every RBI file for the Ruby standard library is maintained by hand.
This means they’re able to have fine grained types, but it also means that
sometimes they’re incomplete or inaccurate.</p>
<p>The Sorbet team is usually too busy to respond to requests to fix individual
bugs in these type annotations for the Ruby standard library. That means there
are two options:</p>
<ol>
<li><p>Submit a pull request to fix the type annotations yourself.</p>
<p>Every RBI file for the Ruby standard library lives <a href="https://github.com/sorbet/sorbet/tree/master/rbi">here</a> in the
Sorbet repo. Find which RBI file you need to edit, and submit a pull request
on GitHub with the changes.</p>
<p>This is the preferred option, because then every Sorbet user will benefit.</p></li>
<li><p>Use an <a href="/docs/troubleshooting#escape-hatches">escape hatch</a> to opt out of
static type checks.</p>
<p>Use this option if you can’t afford to wait for Sorbet to be fixed and
published. (Sorbet publishes new versions to RubyGems nightly).</p></li>
</ol>
<p>If you’re having problems making a change to Sorbet, we’re happy to help on
Slack! See the <a href="/community">Community</a> page for an invite link.</p>
<h2><a class="anchor" aria-hidden="true" id="whats-the-difference-between-tlet-tcast-and-tunsafe"></a><a href="#whats-the-difference-between-tlet-tcast-and-tunsafe" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the difference between <code>T.let</code>, <code>T.cast</code>, and <code>T.unsafe</code>?</h2>
<p><a href="/docs/type-assertions">→ Type Assertions</a></p>
<h2><a class="anchor" aria-hidden="true" id="whats-the-type-signature-for-a-method-with-no-return"></a><a href="#whats-the-type-signature-for-a-method-with-no-return" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the type signature for a method with no return?</h2>
<pre><code class="hljs css language-ruby">sig {void}
</code></pre>
<p><a href="/docs/sigs">→ Method Signatures</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-should-i-add-types-to-methods-defined-with-attr_reader"></a><a href="#how-should-i-add-types-to-methods-defined-with-attr_reader" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How should I add types to methods defined with <code>attr_reader</code>?</h2>
<p>Sorbet has special knowledge for <code>attr_reader</code>, <code>attr_writer</code>, and
<code>attr_accessor</code>. To add types to methods defined with any of these helpers, put
a <a href="/docs/sigs">method signature</a> above the declaration, just like any other method:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># typed: true</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>
  extend T::Sig

  sig {returns(Integer)}
  <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:reader</span>

  sig {params(<span class="hljs-symbol">writer:</span> Integer).returns(Integer)}
  <span class="hljs-keyword">attr_writer</span> <span class="hljs-symbol">:writer</span>

  <span class="hljs-comment"># For attr_accessor, write the sig for the reader portion.</span>
  <span class="hljs-comment"># (Sorbet will use that to write the sig for the writer portion.)</span>
  sig {returns(Integer)}
  <span class="hljs-keyword">attr_accessor</span> <span class="hljs-symbol">:accessor</span>

  sig {void}
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>
    @reader = T.let(<span class="hljs-number">0</span>, Integer)
    @writer = T.let(<span class="hljs-number">0</span>, Integer)
    @accessor = T.let(<span class="hljs-number">0</span>, Integer)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><a href="https://sorbet.run/#%23%20typed%3A%20true%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_reader%20%3Areader%0A%0A%20%20sig%20%7Bparams(writer%3A%20Integer).returns(Integer)%7D%0A%20%20attr_writer%20%3Awriter%0A%0A%20%20%23%20For%20attr_accessor%2C%20write%20the%20sig%20for%20the%20reader%20portion.%0A%20%20%23%20(Sorbet%20will%20use%20that%20to%20write%20the%20sig%20for%20the%20writer%20portion.)%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Aaccessor%0Aend">→
View on sorbet.run</a></p>
<blockquote>
<p>Because Sorbet knows what <code>attr_*</code> methods define what instance variables, in
<code>typed: strict</code> there are some gotchas that apply (which are the same for
<a href="/docs/type-annotations">all other uses</a> of instance variables): in order to use
an instance variable, it must be initialized in the constructor, or be marked
<a href="/docs/nilable-types">nilable</a> (<code>T.nilable(...)</code>).</p>
<p>(<a href="https://sorbet.run/#%23%20typed%3A%20strict%0Aclass%20A%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_reader%20%3Areader%0A%0A%20%20sig%20%7Bparams(writer%3A%20Integer).returns(Integer)%7D%0A%20%20attr_writer%20%3Awriter%0A%0A%20%20%23%20For%20attr_accessor%2C%20write%20the%20sig%20for%20the%20reader%20portion.%0A%20%20%23%20(Sorbet%20will%20use%20that%20to%20write%20the%20sig%20for%20the%20writer%20portion.)%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_accessor%20%3Aaccessor%0A%0A%20%20sig%20%7Bparams(reader%3A%20Integer%2C%20writer%3A%20Integer%2C%20accessor%3A%20Integer).void%7D%0A%20%20def%20initialize(reader%2C%20writer%2C%20accessor)%0A%20%20%20%20%40reader%20%3D%20reader%0A%20%20%20%20%40writer%20%3D%20writer%0A%20%20%20%20%40accessor%20%3D%20accessor%0A%20%20end%0Aend">→
Full example on sorbet.run</a>)</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="whats-the-difference-between-array-and-tarray"></a><a href="#whats-the-difference-between-array-and-tarray" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What’s the difference between <code>Array</code> and <code>T::Array[…]</code>?</h2>
<p><code>Array</code> is the built-in Ruby class for arrays. On the other hand,
<code>T::Array[...]</code> is a Sorbet generic type for arrays. The <code>...</code> must always be
filled in when using it.</p>
<p>While Sorbet implicitly treats <code>Array</code> the same as <code>T::Array[T.untyped]</code>, Sorbet
will error when trying to use <code>T::Array</code> as a standalone type.</p>
<p><a href="/docs/stdlib-generics">→ Generics in the Standard Library</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-accept-a-class-object-and-not-an-instance-of-a-class"></a><a href="#how-do-i-accept-a-class-object-and-not-an-instance-of-a-class" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I accept a class object, and not an instance of a class?</h2>
<p><a href="/docs/class-of">→ T.class_of</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-write-a-signature-for-initialize"></a><a href="#how-do-i-write-a-signature-for-initialize" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I write a signature for <code>initialize</code>?</h2>
<p>When defining <code>initialize</code> for a class, we strongly encourage that you use
<code>.void</code>. This reminds people instantiating your class that they probably meant
to call <code>.new</code>, which is defined on every Ruby class. Typing the result as
<code>.void</code> means that it’s not possible to do anything with the result of
<code>initialize</code>.</p>
<p><a href="/docs/sigs">→ Method Signatures</a></p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-override--what-signature-should-i-use"></a><a href="#how-do-i-override--what-signature-should-i-use" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I override <code>==</code>? What signature should I use?</h2>
<p>Your method should accept <code>BasicObject</code> and return <code>T::Boolean</code>.</p>
<p>Unfortunately, not all <code>BasicObject</code>s have <code>is_a?</code>, so we have to do one extra
step in our <code>==</code> function: check whether <code>Object === other</code>. (In Ruby, <code>==</code> and
<code>===</code> are completely unrelated. The latter has to do with <a href="https://stackoverflow.com/questions/3422223/vs-in-ruby">case subsumption</a>).
The idiomatic way to write <code>Object === other</code> in Ruby is to use <code>case</code>:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-keyword">case</span> other
<span class="hljs-keyword">when</span> Object
  <span class="hljs-comment"># ...</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Here’s a complete example that uses <code>case</code> to implement <code>==</code>:</p>
<p><a href="https://sorbet.run/#%23%20typed%3A%20true%0A%0Aclass%20IntBox%0A%20%20extend%20T%3A%3ASig%0A%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20attr_reader%20%3Aval%0A%20%20%0A%20%20sig%20%7Bparams(val%3A%20Integer).void%7D%0A%20%20def%20initialize(val)%0A%20%20%20%20%40val%20%3D%20val%0A%20%20end%0A%20%20%0A%20%20sig%20%7Bparams(other%3A%20BasicObject).returns(T::Boolean)%7D%0A%20%20def%20%3D%3D(other)%0A%20%20%20%20case%20other%0A%20%20%20%20when%20IntBox%0A%20%20%20%20%20%20other.val%20%3D%3D%20val%0A%20%20%20%20else%0A%20%20%20%20%20%20false%0A%20%20%20%20end%0A%20%20end%0Aend">
→ View on sorbet.run
</a></p>
<h2><a class="anchor" aria-hidden="true" id="i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this"></a><a href="#i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>I use <code>T.must</code> a lot with arrays and hashes. Is there a way around this?</h2>
<p><code>Hash#[]</code> and <code>Array#[]</code> return a <a href="/docs/nilable-types">nilable type</a> because in
Ruby, accessing a Hash or Array returns <code>nil</code> if the key does not exist or is
out-of-bounds. If you would rather raise an exception than handle <code>nil</code>, use the
<code>#fetch</code> method:</p>
<pre><code class="hljs css language-ruby">[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>].fetch(<span class="hljs-number">3</span>) <span class="hljs-comment"># IndexError: index 3 outside of array bounds</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types"></a><a href="#sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sigs are vague for stdlib methods that accept keyword arguments &amp; have multiple return types</h2>
<p>You might notice this when calling <code>Array#sample</code>, <code>Pathname#find</code>, or other
stdlib methods that accept a keyword argument and can have different return
types based on arguments:</p>
<pre><code class="hljs css language-ruby">T.reveal_type([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].sample) <span class="hljs-comment"># Revealed type: T.nilable(T.any(Integer, T::Array[Integer]))</span>
</code></pre>
<p>The sig in Sorbet’s stdlib is quite wide, since it has to cover every possible
return type. Sorbet does not have good support for this for methods that accept
keyword arguments. <a href="https://github.com/sorbet/sorbet/issues/37">#37</a> is the
original report of this.
<a href="https://github.com/sorbet/sorbet/pull/2248#issuecomment-562728417">#2248</a> has
an explanation of why this is hard to fix in Sorbet.</p>
<p>To work around this, you’ll need to use <code>T.cast</code>.</p>
<pre><code class="hljs css language-ruby">item = T.cast([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>].sample, Integer)
T.reveal_type(item) <span class="hljs-comment"># Revealed type: Integer</span>
</code></pre>
<p>In some cases - for example, with complex number conversion methods in
<code>Kernel</code> - the Sorbet team has chosen to ship technically incorrect RBIs that
are much more pragmatic. See <a href="https://github.com/sorbet/sorbet/pull/1144">#1144</a>
for an example. You can do the same for other cases you find annoying, but you
take on the risk of always need to call the method correctly based on your new
sig.</p>
<p>For example, if you are confident you’ll never call <code>Array#sample</code> on an empty
array, use this <a href="/docs/rbi">RBI</a> to not have to worry about <code>nil</code> returns.</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig <span class="hljs-keyword">do</span>
    params(<span class="hljs-symbol">arg0:</span> Integer, <span class="hljs-symbol">random:</span> Random::Formatter)
    .returns(T.any(Elem, T::Array[Elem]))
  <span class="hljs-keyword">end</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample</span><span class="hljs-params">(arg<span class="hljs-number">0</span>=T.unsafe(<span class="hljs-literal">nil</span>)</span></span>, <span class="hljs-symbol">random:</span> T.unsafe(<span class="hljs-literal">nil</span>)); <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Or if you never call it with an argument (you always do <code>[1,2,3].sample</code>, never
<code>[1,2,3].sample(2)</code>), use this RBI to always get an element (not an array) as
your return type:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig <span class="hljs-keyword">do</span>
    params(<span class="hljs-symbol">arg0:</span> Integer, <span class="hljs-symbol">random:</span> Random::Formatter)
    .returns(Elem) <span class="hljs-comment"># or T.nilable(Elem), to also support empty arrays</span>
  <span class="hljs-keyword">end</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample</span><span class="hljs-params">(arg<span class="hljs-number">0</span>=T.unsafe(<span class="hljs-literal">nil</span>)</span></span>, <span class="hljs-symbol">random:</span> T.unsafe(<span class="hljs-literal">nil</span>)); <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<blockquote>
<p>Overriding stdlib RBIs can make type checking less safe, since Sorbet will now
have an incorrect understanding of how the stdlib behaves.</p>
</blockquote>
<p>Another alternative is to define new methods that are stricter about arguments,
and use these in place of stdlib methods:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Array</span></span>
  extend T::Sig

  sig { returns(Elem) } <span class="hljs-comment"># or T.nilable(Elem) unless you're confident this is never called on empty arrays</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample_one</span></span>
    T.cast(sample, Elem)
  <span class="hljs-keyword">end</span>

  sig { params(<span class="hljs-symbol">n:</span> Integer).returns(T::Array[Elem]) }
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">sample_n</span><span class="hljs-params">(n)</span></span>
    T.cast(sample(n), T::Array[Elem])
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="why-is-super-is-untyped-even-when-the-parent-method-has-a-sig"></a><a href="#why-is-super-is-untyped-even-when-the-parent-method-has-a-sig" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why is <code>super</code> is untyped, even when the parent method has a <code>sig</code>?</h2>
<p>Sorbet can’t know what the “parent method” is 100% of the time. For example,
when calling <code>super</code> from a method defined in a module, the <code>super</code> method will
be determined only once we know which class or module this module has been mixed
into. That’s a lot of words, so here’s an example:</p>
<p><a href="https://sorbet.run/#%23%20typed%3A%20true%0Amodule%20MyModule%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20def%20foo%0A%20%20%20%20%23%20Can't%20know%20super%20until%20we%20know%20which%20module%20we're%20mixed%20into%0A%20%20%20%20res%20%3D%20super%0A%20%20%20%20T.reveal_type(res)%0A%20%20%20%20res%0A%20%20end%0Aend%0A%0Amodule%20ParentModule1%0A%20%20sig%20%7Breturns(Integer)%7D%0A%20%20def%20foo%0A%20%20%20%200%0A%20%20end%0Aend%0A%0Amodule%20ParentModule2%0A%20%20sig%20%7Breturns(String)%7D%0A%20%20def%20foo%0A%20%20%20%20''%0A%20%20end%0Aend%0A%0Aclass%20MyClass1%0A%20%20include%20ParentModule1%0A%20%20include%20MyModule%0Aend%0A%0Aclass%20MyClass2%0A%20%20include%20ParentModule2%0A%20%20include%20MyModule%0Aend%0A%0AMyClass1.new.foo%0AMyClass2.new.foo%0A">→
View on sorbet.run</a></p>
<p>To typecheck this example, Sorbet would have to typecheck <code>MyModule#foo</code>
multiple times, once for each place that method might be used from, or place
restrictions on how and where this module can be included.</p>
<p>Sorbet might adopt a more sophisticated approach in the future, but for now it
falls back to treating <code>super</code> as a method call that accepts anything and
returns anything.</p>
<h2><a class="anchor" aria-hidden="true" id="does-sorbet-work-with-rake-and-rakefiles"></a><a href="#does-sorbet-work-with-rake-and-rakefiles" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Does Sorbet work with Rake and Rakefiles?</h2>
<p>Kind of, with some effort. Rake monkey patches the global <code>main</code> object (i.e.,
top-level code) to extend their DSL, which Sorbet cannot understand:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># -- from lib/rake/dsl_definition.rb --</span>

...

<span class="hljs-comment"># Extend the main object with the DSL commands. This allows top-level</span>
<span class="hljs-comment"># calls to task, etc. to work from a Rakefile without polluting the</span>
<span class="hljs-comment"># object inheritance tree.</span>
<span class="hljs-keyword">self</span>.extend Rake::DSL
</code></pre>
<p>→
<a href="https://github.com/ruby/rake/blob/80e00e2d59ea5b230f2f0416c387c0b57184f1ff/lib/rake/dsl_definition.rb#L192-L195">lib/rake/dsl_definition.rb</a></p>
<p>Sorbet cannot model that a single instance of an object (in this case <code>main</code>)
has a different inheritance hierarchy than that instance’s class (in this case
<code>Object</code>).</p>
<p>To get around this, factor out all tasks defined the <code>Rakefile</code> that should be
typechecked into an explicit class in a separate file, something like this:</p>
<pre><code class="hljs css language-ruby"><span class="hljs-comment"># -- my_rake_tasks.rb --</span>

<span class="hljs-comment"># (1) Make a proper class inside a file with a *.rb extension</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyRakeTasks</span></span>
  <span class="hljs-comment"># (2) Explicitly extend Rake::DSL in this class</span>
  extend Rake::DSL

  <span class="hljs-comment"># (3) Define tasks like normal:</span>
  task <span class="hljs-symbol">:test</span> <span class="hljs-keyword">do</span>
    puts <span class="hljs-string">'Testing...'</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-comment"># ... more tasks ...</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># -- Rakefile --</span>

<span class="hljs-comment"># (4) Require that file from the Rakefile</span>
require_relative <span class="hljs-string">'./my_rake_tasks'</span>
</code></pre>
<p>For more information, see
<a href="https://stackoverflow.com/a/60556206/1015863">this StackOverflow question</a>.</p>
<h2><a class="anchor" aria-hidden="true" id="how-do-i-upgrade-sorbet"></a><a href="#how-do-i-upgrade-sorbet" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How do I upgrade Sorbet?</h2>
<p>Sorbet has not reached version 1.0 yet. As such, it will make breaking changes
constantly, without warning.</p>
<p>To upgrade a patch level (e.g., from 0.4.4314 to 0.4.4358):</p>
<pre><code class="hljs"><span class="hljs-attr">bundle</span> <span class="hljs-string">update sorbet sorbet-runtime</span>
<span class="hljs-comment"># also update plugins like sorbet-rails, if any</span>
<span class="hljs-attr">bundle</span> <span class="hljs-string">exec srb init</span>
<span class="hljs-comment">
# For plugins like sorbet-rails, see their docs, eg.</span>
<span class="hljs-attr">https</span>:<span class="hljs-string">//github.com/chanzuckerberg/sorbet-rails#initial-setup</span>
<span class="hljs-comment">
# Optional: Suggest new, stronger sigils (per-file strictness</span>
<span class="hljs-comment"># levels) when possible. Currently, the suggestion process is</span>
<span class="hljs-comment"># fallible, and may suggest downgrading when it's not necessary.</span>
<span class="hljs-attr">bundle</span> <span class="hljs-string">exec srb rbi suggest-typed</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="what-platforms-does-sorbet-support"></a><a href="#what-platforms-does-sorbet-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What platforms does Sorbet support?</h2>
<p>The <code>sorbet-runtime</code> gem is currently only tested on Ruby 2.6 and Ruby 2.7. It
is known to not support Ruby 2.4. Feel free to report runtime issues for any
current or future Ruby version.</p>
<p>The <code>sorbet-static</code> gem is known to support Ruby 2.4, Ruby 2.5, Ruby 2.6, and
Ruby 2.7 to a minimum level (i.e., it can at least parse syntax introduced in
those versions). Some language features are typed more strictly than others
(generally, language features in newer Ruby versions have looser type support).
This is not by design, just by convenience. Feel free to open feature requests
that various (new or old) language features be typed more strictly.</p>
<p>Sorbet bundles <a href="/docs/rbi">RBI files</a> for the standard library. In Ruby the
standard library changes with the Ruby version being used, but Sorbet only ships
one set of RBI definitions for the standard library. In particular, Sorbet’s RBI
files for the standard library might reflect classes, methods, or APIs that are
only available in a version of Ruby newer than the one used to run a given
project. You will have to rely on (runtime) test suites to verify that your
project does not use new standard library APIs with an old Ruby version.</p>
<p>The <code>sorbet-static</code> gem is only tested on macOS 10.14 (Mojave) and Ubuntu 18
(Bionic Beaver). There is currently no Windows support. We expect
<code>sorbet-static</code> to work as far back as macOS 10.10 (Yosemite), as far forward as
macOS 11.0 Big Sur, and on most Linux distributions using <code>glibc</code>.</p>
<p>We do not test nor publish prebuilt binaries for macOS on Apple Silicon. We have
reports that it doesn’t work, but no one on the Sorbet team has access to Apple
Silicon-based macOS machines, so we have been unable to diagnose nor fix any
problems. If you are interested in working on this, feel free to reach out in
the #internals channel on our <a href="/slack">Sorbet Slack</a>.</p>
<p>The <code>sorbet</code> gem has runtime dependencies on <code>git</code> and <code>bash</code>.</p>
<p>Combined, these points mean that if you are using one of the official minimal
Ruby Docker images (which are based on Apline Linux), you will need to install
some support libraries:</p>
<pre><code class="hljs css language-Dockerfile"><span class="hljs-keyword">FROM</span> ruby:<span class="hljs-number">2.6</span>-alpine

<span class="hljs-keyword">RUN</span><span class="bash"> apk add --no-cache --update \
    git \
    bash \
    ca-certificates \
    wget</span>

<span class="hljs-keyword">ENV</span> GLIBC_RELEASE_VERSION <span class="hljs-number">2.30</span>-r0
<span class="hljs-keyword">RUN</span><span class="bash"> wget -nv -O /etc/apk/keys/sgerrand.rsa.pub https://alpine-pkgs.sgerrand.com/sgerrand.rsa.pub &amp;&amp; \
    wget -nv https://github.com/sgerrand/alpine-pkg-glibc/releases/download/<span class="hljs-variable">${GLIBC_RELEASE_VERSION}</span>/glibc-<span class="hljs-variable">${GLIBC_RELEASE_VERSION}</span>.apk &amp;&amp; \
    apk add glibc-<span class="hljs-variable">${GLIBC_RELEASE_VERSION}</span>.apk &amp;&amp; \
    rm /etc/apk/keys/sgerrand.rsa.pub &amp;&amp; \
    rm glibc-<span class="hljs-variable">${GLIBC_RELEASE_VERSION}</span>.apk</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="does-sorbet-support-activerecord-and-rails"></a><a href="#does-sorbet-support-activerecord-and-rails" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Does Sorbet support ActiveRecord (and Rails?)</h2>
<p><a href="https://github.com/chanzuckerberg/sorbet-rails">sorbet-rails</a> is a community-maintained project which can help generate RBI
files for certain Rails constructs.</p>
<p>Also see the <a href="/en/community">Community</a> page for more community-maintained projects!</p>
<h2><a class="anchor" aria-hidden="true" id="can-i-convert-from-yard-docs-to-sorbet-signatures"></a><a href="#can-i-convert-from-yard-docs-to-sorbet-signatures" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Can I convert from YARD docs to Sorbet signatures?</h2>
<p><a href="https://github.com/AaronC81/sord">Sord</a> is a community-maintained project which can generate Sorbet RBI files
from YARD docs.</p>
<p>Also see the <a href="/en/community">Community</a> page for more community-maintained projects!</p>
<h2><a class="anchor" aria-hidden="true" id="when-ruby-3-gets-types-what-will-the-migration-plan-look-like"></a><a href="#when-ruby-3-gets-types-what-will-the-migration-plan-look-like" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When Ruby 3 gets types, what will the migration plan look like?</h2>
<p>The Sorbet team is actively involved in the Ruby 3 working group for static
typing. There are some things we know and something we don’t know about Ruby 3.</p>
<p>Ruby 3 plans to ship type annotations for the standard library. These type
annotations for the standard library will live in separate Ruby Signature (RBS)
files, with the <code>*.rbs</code> extension. The exact syntax is not yet finalized. When
the syntax is finalized, Sorbet intends to ingest both RBS and RBI formats, so
that users can choose their favorite.</p>
<p>Ruby 3 has no plans to change Ruby’s syntax. To have type annotations for
methods live in the same place as the method definition, the only option will be
to continue using Sorbet’s <a href="/docs/sigs">method signatures</a>. As such, the Sorbet
docs will always use RBI syntax in examples, because the syntax is the same for
signatures both within a Ruby file and in external <a href="/docs/rbi">RBI files</a>.</p>
<p>Ruby 3 has no plans to ship a type checker for RBS annotations. Instead, Ruby 3
plans to ship a type profiler, which will attempt to guess signatures for code
without signatures. The only way to get type checking will be to use third party
tools, like Sorbet.</p>
<p>Ruby 3 plans to ship no specification for what the type annotations mean. Each
third party type checker and the Ruby 3 type profiler will be allowed to ascribe
their own meanings to individual type annotations. When there are ambiguities or
constructs that one tool doesn’t understand, it should fall back to <code>T.untyped</code>
(or the equivalent in whatever RBS syntax decides to use for
<a href="/docs/untyped">this construct</a>).</p>
<p>Ruby 3 plans to seed the initial type annotations for the standard library from
Sorbet’s extensive existing type annotations for the standard library. Sorbet
already has great type annotations for the standard library in the form of
<a href="/docs/rbi">RBI files</a> which are used to type check millions of lines of production
Ruby code every day.</p>
<p>From all of this, we have every reason to believe that users of Sorbet will have
a smooth transition to Ruby 3:</p>
<ul>
<li>You will be able to either keep using Sorbet’s RBI syntax or switch to using
RBS syntax.</li>
<li>The type definitions for the standard library will mean the same (because they
will have come from Sorbet!) but have a different syntax.</li>
<li>For inline type annotations with Ruby 3, you will have to continue using
Sorbet’s <code>sig</code> syntax, no different from today.</li>
</ul>
<p>For more information, watch <a href="https://youtu.be/2g9R7PUCEXo?t=2022">this section</a>
from Matz’s RubyConf 2019 keynote, which talks about his plans for typing in
Ruby 3.</p>
<h2><a class="anchor" aria-hidden="true" id="can-i-use-sorbet-for-duck-typed-code"></a><a href="#can-i-use-sorbet-for-duck-typed-code" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Can I use Sorbet for duck typed code?</h2>
<p>No. You can use an <a href="/docs/abstract">interface</a> instead, or <code>T.untyped</code> if you do
not control all of the code.</p>
<p>Duck typing (or, more formally, Structural typing) specifies types by their
structure. For example, Rack middleware accepts any object that has a <code>call</code>
method which takes one argument and returns a tuple representing an HTTP
response.</p>
<p>Sorbet does not support duck typing either for static analysis or runtime
checking.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/troubleshooting"><span class="arrow-prev">← </span><span>Troubleshooting</span></a><a class="docs-next button" href="/docs/error-reference"><span>Error Reference</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#why-does-sorbet-think-this-is-nil-i-just-checked-that-its-not">Why does Sorbet think this is <code>nil</code>? I just checked that it's not!</a></li><li><a href="#it-looks-like-sorbets-types-for-the-stdlib-are-wrong">It looks like Sorbet's types for the stdlib are wrong.</a></li><li><a href="#whats-the-difference-between-tlet-tcast-and-tunsafe">What's the difference between <code>T.let</code>, <code>T.cast</code>, and <code>T.unsafe</code>?</a></li><li><a href="#whats-the-type-signature-for-a-method-with-no-return">What's the type signature for a method with no return?</a></li><li><a href="#how-should-i-add-types-to-methods-defined-with-attr_reader">How should I add types to methods defined with <code>attr_reader</code>?</a></li><li><a href="#whats-the-difference-between-array-and-tarray">What's the difference between <code>Array</code> and <code>T::Array[…]</code>?</a></li><li><a href="#how-do-i-accept-a-class-object-and-not-an-instance-of-a-class">How do I accept a class object, and not an instance of a class?</a></li><li><a href="#how-do-i-write-a-signature-for-initialize">How do I write a signature for <code>initialize</code>?</a></li><li><a href="#how-do-i-override--what-signature-should-i-use">How do I override <code>==</code>? What signature should I use?</a></li><li><a href="#i-use-tmust-a-lot-with-arrays-and-hashes-is-there-a-way-around-this">I use <code>T.must</code> a lot with arrays and hashes. Is there a way around this?</a></li><li><a href="#sigs-are-vague-for-stdlib-methods-that-accept-keyword-arguments--have-multiple-return-types">Sigs are vague for stdlib methods that accept keyword arguments &amp; have multiple return types</a></li><li><a href="#why-is-super-is-untyped-even-when-the-parent-method-has-a-sig">Why is <code>super</code> is untyped, even when the parent method has a <code>sig</code>?</a></li><li><a href="#does-sorbet-work-with-rake-and-rakefiles">Does Sorbet work with Rake and Rakefiles?</a></li><li><a href="#how-do-i-upgrade-sorbet">How do I upgrade Sorbet?</a></li><li><a href="#what-platforms-does-sorbet-support">What platforms does Sorbet support?</a></li><li><a href="#does-sorbet-support-activerecord-and-rails">Does Sorbet support ActiveRecord (and Rails?)</a></li><li><a href="#can-i-convert-from-yard-docs-to-sorbet-signatures">Can I convert from YARD docs to Sorbet signatures?</a></li><li><a href="#when-ruby-3-gets-types-what-will-the-migration-plan-look-like">When Ruby 3 gets types, what will the migration plan look like?</a></li><li><a href="#can-i-use-sorbet-for-duck-typed-code">Can I use Sorbet for duck typed code?</a></li></ul></nav></div><footer class="nav-footer" id="footer"><div class="wrapper"><p class="footer">© 2022 Stripe · <a href="/docs/adopting">Get started</a> · <a href="/docs/overview">Docs</a> · <a href="https://sorbet.run">Try</a> · <a href="/en/community">Community</a> · <a href="/blog">Blog</a> · <a href="https://twitter.com/sorbet_ruby">Twitter</a></p></div></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                appId: 'ZYWC6Z01G8',
                apiKey: 'b05a65e9f8d9f50dc4ec3241db8836c4',
                indexName: 'stripe_sorbet',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>